(function(e){function t(t){for(var l,n,o=t[0],s=t[1],c=t[2],d=0,p=[];d<o.length;d++)n=o[d],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&p.push(i[n][0]),i[n]=0;for(l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l]);u&&u(t);while(p.length)p.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],l=!0,o=1;o<a.length;o++){var s=a[o];0!==i[s]&&(l=!1)}l&&(r.splice(t--,1),e=n(n.s=a[0]))}return e}var l={},i={app:0},r=[];function n(t){if(l[t])return l[t].exports;var a=l[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=l,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)n.d(a,l,function(t){return e[t]}.bind(null,l));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=s;r.push([1,"chunk-vendors"]),a()})({0:function(e,t){},1:function(e,t,a){e.exports=a("56d7")},"1ca1":function(e,t,a){"use strict";a("56e2")},2:function(e,t){},3:function(e,t){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var l=a("2b0e"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("common-fault")],1)},r=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"partner-company"},[a("el-container",[a("el-header",{staticClass:"header"},[a("el-form",{ref:"searchValidateForm",staticClass:"search-validate-form",attrs:{inline:!0,model:e.searchValidateForm,"label-width":"100px",rules:e.searchValidateFormRules}},[a("el-form-item",{attrs:{label:"",prop:"title"}},[a("el-input",{staticClass:"input-name",attrs:{placeholder:"问题"},model:{value:e.searchValidateForm.title,callback:function(t){e.$set(e.searchValidateForm,"title",t)},expression:"searchValidateForm.title"}})],1),a("el-form-item",{attrs:{label:"",prop:"applicableModel"}},[a("el-input",{staticClass:"input-name",attrs:{placeholder:"机器型号"},model:{value:e.searchValidateForm.applicableModel,callback:function(t){e.$set(e.searchValidateForm,"applicableModel",t)},expression:"searchValidateForm.applicableModel"}})],1)],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.onSearch("searchValidateForm")}}},[e._v("搜索")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh-right"},on:{click:e.onReset}},[e._v("重置")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.onAdd}},[e._v("新增")])],1),a("el-main",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingTable,expression:"loadingTable"}],staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","header-cell-style":{background:"#f2f2f2",color:"#606266",height:"38px",padding:"0px"},"cell-style":{height:"38px",padding:"0"}}},[e._l(e.tableFields,(function(t,l){return a("el-table-column",{key:l,attrs:{prop:t,label:l,"min-width":"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(l){return[a("div",["resolvent"==t?[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.detailRow(l.$index,l.row)}}},[e._v(" "+e._s(e.tableContentValue(l.row,t))+" ")])]:[e._v(" "+e._s(e.tableContentValue(l.row,t))+" ")]],2)]}}],null,!0)})})),a("el-table-column",{attrs:{label:"操作","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.editRow(t.$index,t.row)}}},[e._v(" 编辑 ")]),a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.deleteRow(t.$index,t.row)}}},[e._v(" 删除 ")])]}}])})],2),a("el-table",{staticClass:"table",staticStyle:{width:"100%",display:"none"},attrs:{id:"outTable",data:e.exportTableData,border:""}},e._l(e.tableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t,"min-width":"130",align:"center"}})})),1)],1),a("el-footer",[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total, sizes, jumper",total:e.total,"current-page":e.currentPage,"page-sizes":[10,20,30,40,50,60,70,80,90],"page-size":e.pageSize},on:{"current-change":e.onCurrentChange,"size-change":e.onSizeChange}})],1)]),a("el-dialog",{staticClass:"dialog",attrs:{title:e.dialogTitle,visible:e.dialogVisible,"before-close":e.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"validateForm",staticClass:"demo-ruleForm",attrs:{model:e.validateForm,"label-width":"100px",rules:e.validateFormRules}},[a("el-form-item",{attrs:{label:"问题标题",prop:"title"}},[a("el-input",{attrs:{type:"text",autocomplete:"off",placeholder:"请输入问题标题"},model:{value:e.validateForm.title,callback:function(t){e.$set(e.validateForm,"title",t)},expression:"validateForm.title"}})],1),a("el-form-item",{attrs:{label:"现象",prop:"phenomenon"}},[a("el-input",{attrs:{type:"text",autocomplete:"off",placeholder:"请输入现象"},model:{value:e.validateForm.phenomenon,callback:function(t){e.$set(e.validateForm,"phenomenon",t)},expression:"validateForm.phenomenon"}})],1),a("el-form-item",{attrs:{label:"解决方法",prop:"resolvent"}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"fs-18"},[e._v("新增解决方法")]),a("el-button",{staticClass:"fs-24",staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:e.onAddResolventItem}})],1),e._l(e.resolventList,(function(t,l){return a("div",{key:l,staticClass:"resolvent-item"},[a("el-input",{ref:"resolventInputRef",refInFor:!0,attrs:{type:"text",autocomplete:"off",placeholder:"请输入解决方法"},model:{value:t.title,callback:function(a){e.$set(t,"title",a)},expression:"item.title"}}),e.updateUpload?a("el-upload",{ref:"upload",refInFor:!0,staticClass:"upload-demo",attrs:{action:"/system/common/uploadFile",name:"file",accept:".jpg,.png, video/*","on-preview":e.handlePreview(t.type),"on-remove":e.handleRemove(l),"before-remove":e.beforeRemove,"before-upload":e.beforeUpload,limit:3,"on-exceed":e.handleExceed,"file-list":t.fileList,"on-success":e.handleSuccess(l)}},[a("el-button",{staticClass:"ml-10",attrs:{type:"primary"}},[e._v("点击上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传一个jpg、png或mp4文件，且不超过100MB ")])],1):e._e(),a("el-button",{staticClass:"fs-24",staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text",icon:"el-icon-remove-outline"},on:{click:function(t){return e.onDeleteResolventItem(l)}}}),a("el-dialog",{attrs:{visible:e.uploadDialogVisible,"append-to-body":""},on:{"update:visible":function(t){e.uploadDialogVisible=t}}},[1==e.currentPreType?[a("img",{attrs:{width:"100%",src:e.previewImgUrl,alt:""}})]:e._e(),2==e.currentPreType?[a("video",{attrs:{src:e.previewVideoUrl,autoplay:"",width:"100%"}})]:e._e(),3==e.currentPreType?[e._v(" 其他类型的文件暂不支持查看 ")]:e._e()],2)],1)}))],2)],1),a("el-form-item",{attrs:{label:"适用机型",prop:"applicableModel"}},[a("el-input",{attrs:{type:"text",autocomplete:"off",placeholder:"请输入适用机型"},model:{value:e.validateForm.applicableModel,callback:function(t){e.$set(e.validateForm,"applicableModel",t)},expression:"validateForm.applicableModel"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"notes"}},[a("el-input",{attrs:{type:"text",autocomplete:"off",placeholder:"请输入备注"},model:{value:e.validateForm.notes,callback:function(t){e.$set(e.validateForm,"notes",t)},expression:"validateForm.notes"}})],1)],1),a("div",{staticClass:"submit"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("validateForm")}}},[e._v("提交")]),a("el-button",{on:{click:e.dialogClose}},[e._v("取消")])],1)],1),a("el-dialog",{staticClass:"dialog",attrs:{title:"",visible:e.detailDialogVisible,"before-close":e.detailHandleClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.detailDialogVisible=t}}},[a("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.collapseList,(function(t,l){return a("el-collapse-item",{key:l,attrs:{title:t.title,name:l}},[1==t.type?[a("img",{attrs:{width:"100%",src:t.url,alt:""}})]:2==t.type?[a("video",{attrs:{width:"100%",src:t.url,autoplay:""}})]:3==t.type?[e._v(" 其他类型的文件暂不支持查看 ")]:[e._v(" 该解决方案没有上传附件 ")]],2)})),1)],1)],1)],1)},o=[],s=a("1da1");a("96cf"),a("a9e3"),a("159b"),a("a434"),a("99af"),a("b0c0"),a("21a6"),a("1146"),a("ac1f"),a("1276");function c(e){var t="",a="";try{var l=e.split(".");t=l[l.length-1]}catch(n){t=""}if(!t)return a=!1,a;var i=["png","jpg","jpeg","bmp","gif","webp","heif","heic"];if(a=i.some((function(e){return e==t})),a)return a="image",a;var r=["mp4","3gp","webm","mkv"];return a=r.some((function(e){return e==t})),a?(a="video",a):(a="other",a)}var u={name:"CommonFault",data:function(){return{searchCompanyName:"",tableFields:{"问题标题":"title","现象":"phenomenon","解决方法":"resolvent","适用机型":"applicableModel","创建时间":"createTime","备注":"notes"},tableData:[],exportTableData:[],downloadLoading:!1,loadingTable:!1,currentPage:1,pageSize:10,dialogVisible:!1,dialogState:"",searchValidateForm:{title:"",applicableModel:""},searchVF:{title:"",applicableModel:""},validateForm:{},total:0,dialogTitle:"",collapseList:[],resolventList:[],previewImgUrl:"",previewVideoUrl:"",previewOtherUrl:"",uploadDialogVisible:!1,detailDialogVisible:!1,currentPreType:"",updateUpload:!0,activeName:"",validateFormRules:{title:[{validator:this.checkRequireMethod("问题标题"),required:!0,trigger:["blur","change"]}],resolvent:[{validator:this.checkRequireMethod("解决方法"),required:!0,trigger:["blur","change"]}],applicableModel:[{validator:this.checkRequireMethod("适用机型"),required:!0,trigger:["blur","change"]}]},searchValidateFormRules:{}}},created:function(){this.initTableData(),this.getValidateForm()},methods:{checkRequireMethod:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(a,l,i){var r=!1;if(e.resolventList.forEach((function(e){if("解决方法"==t&&e&&!e.title)return r=!1,i(new Error(t+"不能为空"));r=!0})),"解决方法"==t&&r&&(l="这里随便给一个值就行"),!l)return i(new Error(t+"不能为空"));i()}},getValidateForm:function(){var e={};for(var t in this.tableFields)e[this.tableFields[t]]="";this.validateForm=e},login:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/loginSystem?username=lijiazhao&password=lijiazhao");case 2:a=t.sent,a.data;case 4:case"end":return t.stop()}}),t)})))()},initTableData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,l,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.searchVF.title,""!=a&&a||(a=null),l=e.searchVF.applicableModel,""!=l&&l||(l=null),e.loadingTable=!0,t.next=7,e.$http.get("/system/common_fault/list",{params:{title:a,applicableModel:l,pageNum:(e.currentPage-1)*e.pageSize,pageSize:e.pageSize}});case 7:if(i=t.sent,r=i.data,"200"!=r.state){t.next=15;break}e.tableData=r.data.list,e.total=r.data.total,e.loadingTable=!1,t.next=17;break;case 15:return e.$message({message:r.msg,type:"error",offset:100,center:!0,duration:3e3}),t.abrupt("return");case 17:case"end":return t.stop()}}),t)})))()},addTableData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/system/common_fault/add",e.validateForm);case 2:a=t.sent,l=a.data,"200"==l.state?(e.$message({message:l.msg,type:"success",offset:100,center:!0,duration:1e3}),e.initTableData(),e.$refs.validateForm.resetFields()):e.$message({message:l.msg,type:"error",offset:100,center:!0,duration:3e3});case 5:case"end":return t.stop()}}),t)})))()},editTableData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/system/common_fault/edit",e.validateForm);case 2:a=t.sent,l=a.data,"200"==l.state?(e.$message({message:l.msg,type:"success",offset:100,center:!0,duration:1e3}),e.initTableData()):e.$message({message:l.msg,type:"error",offset:100,center:!0,duration:3e3});case 5:case"end":return t.stop()}}),t)})))()},getTableData:function(){this.searchValidateForm.title==this.searchVF.title&&this.searchValidateForm.applicableModel==this.searchVF.applicableModel||(this.searchVF.title=this.searchValidateForm.title,this.searchVF.applicableModel=this.searchValidateForm.applicableModel,console.log("调用接口"),this.initTableData())},onSearch:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;t.getTableData()}))},onReset:function(){this.searchValidateForm.title="",this.searchValidateForm.applicableModel="",this.currentPage=1,this.pageSize=10,this.getTableData()},onAdd:function(){this.dialogVisible=!0,this.dialogState="add",this.dialogTitle="新增常见故障"},editRow:function(e,t){this.dialogVisible=!0;var a=Object.assign({},t);this.validateForm=a,this.resolventList=JSON.parse(a.resolvent).data,this.dialogState="edit",this.dialogTitle="编辑常见故障"},deleteRow:function(e,t){var a=this;this.$confirm("此操作将删除该行数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){var l,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return l=a.$qs.stringify({id:t.id}),e.next=3,a.$http.post("/system/common_fault/delete",l);case 3:i=e.sent,r=i.data,"200"==r.state?(a.$message({type:"success",message:r.msg,offset:100,center:!0,duration:1e3}),a.initTableData()):a.$message({type:"error",message:r.msg,offset:100,center:!0,duration:3e3});case 6:case"end":return e.stop()}}),e)})))).catch((function(){a.$message({type:"info",message:"已取消删除",offset:100,center:!0,duration:1e3})}))},detailRow:function(e,t){console.log(e,t),this.detailDialogVisible=!0;var a=JSON.parse(t.resolvent).data,l=[];a.forEach((function(e){l.push({title:e&&e.title,url:e&&e.fileList&&e.fileList[0]&&e.fileList[0].url,type:e&&e.type})})),this.collapseList=l},dialogClose:function(){this.dialogVisible=!1,this.$refs.validateForm.resetFields(),this.getValidateForm(),this.resolventList=[]},handleClose:function(e){e(),this.$refs.validateForm.resetFields(),this.getValidateForm(),this.resolventList=[]},detailHandleClose:function(e){this.activeName="",e(),this.detailDialogVisible=!1},submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(a){var l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=11;break}l={data:t.resolventList},t.validateForm.resolvent=JSON.stringify(l),console.log(t.validateForm),"add"==t.dialogState?(console.log("新增公司信息"),t.addTableData()):"edit"==t.dialogState&&(console.log("编辑公司信息"),t.editTableData()),t.dialogVisible=!1,t.$refs.validateForm.resetFields(),t.getValidateForm(),t.resolventList=[],e.next=13;break;case 11:return console.log("error submit!!"),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},onCurrentChange:function(e){this.currentPage=e,this.initTableData()},onSizeChange:function(e){this.pageSize=e,this.initTableData()},onAddResolventItem:function(){console.log("新增解决步骤"),this.resolventList.push({title:""})},onDeleteResolventItem:function(e){console.log("删除解决步骤"),this.resolventList.splice(e,1),this.$refs.resolventInputRef[0].focus(),this.$refs.resolventInputRef[0].blur()},handleRemove:function(e){var t=this;return function(a,l){var i=t.resolventList[e];i&&(i.fileList&&(i.fileList=[]),i.type&&(i.type=""))}},handlePreview:function(e){var t=this;return function(a){console.log(e),t.currentPreType=e,t.uploadDialogVisible=!0,1==e?t.previewImgUrl=a.url:2==e?t.previewVideoUrl=a.url:3==e&&(t.previewOtherUrl=a.url)}},handleExceed:function(e,t){this.$message.warning("当前限制选择 3 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},beforeRemove:function(e,t){},beforeUpload:function(e){var t=e.type;if(console.log(t),"image/jpeg"!==t&&"image/png"!==t&&"video/mp4"!==t)return this.$message.warning("当前仅能上传jpg、png或mp4文件"),!1},reloadUpload:function(){var e=this;this.updateUpload=!1,this.$nextTick((function(){e.updateUpload=!0}))},handleSuccess:function(e){var t=this;return function(a,l,i){if(console.log(l),l.size>524288e3)return console.log("上传文件大小不能大于500MB"),t.$notify({title:"文件过大",message:"上传文件大小不能大于500MB"}),!1;l.url="/"+l.response.data,t.resolventList[e].fileList=[l],t.reloadUpload();var r=c(l.name);"image"==r?t.resolventList[e].type=1:"video"==r?t.resolventList[e].type=2:"other"==r&&(t.resolventList[e].type=3)}}},computed:{tableContentValue:function(){return function(e,t){var a="";if("resolvent"==t){try{JSON.parse(e[t]),a="见详情"}catch(l){a=e[t]}}else a=e[t];return a}}},components:{}},d=u,p=(a("1ca1"),a("2877")),f=Object(p["a"])(d,n,o,!1,null,"34003fa4",null),m=f.exports,h={name:"App",components:{CommonFault:m}},v=h,g=(a("5c0b"),Object(p["a"])(v,i,r,!1,null,null,null)),b=g.exports,y=a("2f62");l["default"].use(y["a"]);var F=new y["a"].Store({state:{},mutations:{},actions:{},modules:{}}),w=(a("9e1f"),a("450d"),a("6ed5")),x=a.n(w),V=(a("0fb7"),a("f529")),k=a.n(V),$=(a("b0ee"),a("d180")),_=a.n($),C=(a("a335"),a("c0bb")),R=a.n(C),T=(a("f225"),a("89a9")),S=a.n(T),D=(a("b8e0"),a("a4c4")),M=a.n(D),O=(a("be4f"),a("896a")),j=a.n(O),L=(a("eca7"),a("3787")),z=a.n(L),P=(a("425f"),a("4105")),U=a.n(P),I=(a("a7cc"),a("df33")),N=a.n(I),q=(a("672e"),a("101e")),E=a.n(q),J=(a("5466"),a("ecdf")),A=a.n(J),B=(a("38a0"),a("ad41")),H=a.n(B),G=(a("10cb"),a("f3ad")),K=a.n(G),Q=(a("bdc7"),a("aa2f")),W=a.n(Q),X=(a("de31"),a("c69e")),Y=a.n(X),Z=(a("a673"),a("7b31")),ee=a.n(Z),te=(a("adec"),a("3d2d")),ae=a.n(te),le=(a("1f1a"),a("4e4b")),ie=a.n(le),re=(a("1951"),a("eedf")),ne=a.n(re);l["default"].use(ne.a),l["default"].use(ie.a),l["default"].use(ae.a),l["default"].use(ee.a),l["default"].use(Y.a),l["default"].use(W.a),l["default"].use(K.a),l["default"].use(H.a),l["default"].use(A.a),l["default"].use(E.a),l["default"].use(N.a),l["default"].use(U.a),l["default"].use(z.a),l["default"].use(j.a),l["default"].use(M.a),l["default"].use(S.a),l["default"].use(R.a),l["default"].use(_.a),l["default"].prototype.$message=k.a,l["default"].prototype.$confirm=x.a.confirm;var oe=a("bc3a"),se=a.n(oe),ce=a("4328"),ue=a.n(ce);se.a.defaults.withCredentials=!0,l["default"].prototype.$http=se.a,l["default"].prototype.$qs=ue.a,l["default"].config.productionTip=!1,new l["default"]({store:F,render:function(e){return e(b)}}).$mount("#app")},"56e2":function(e,t,a){},"5c0b":function(e,t,a){"use strict";a("9c0c")},"9c0c":function(e,t,a){}});
//# sourceMappingURL=app.e94ecf65.js.map