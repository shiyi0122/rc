(function(e){function t(t){for(var n,i,s=t[0],l=t[1],c=t[2],p=0,u=[];p<s.length;p++)i=s[p],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&u.push(r[i][0]),r[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);d&&d(t);while(u.length)u.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,s=1;s<a.length;s++){var l=a[s];0!==r[l]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},r={app:0},o=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var d=l;o.push([1,"chunk-vendors"]),a()})({0:function(e,t){},"0f2c":function(e,t,a){"use strict";a("f6b5")},1:function(e,t,a){e.exports=a("56d7")},2:function(e,t){},3:function(e,t){},"56d7":function(e,t,a){"use strict";a.r(t);a("0fae");var n=a("9e2f"),r=a.n(n),o=(a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("2b0e")),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("stream-account")],1)},s=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"partner-company"},[a("el-container",[a("el-header",{staticClass:"header",staticStyle:{height:"100px"}},[a("el-form",{ref:"searchValidateForm",staticClass:"search-validate-form",attrs:{inline:!0,model:e.searchValidateForm,"label-width":"100px",rules:e.searchValidateFormRules}},[a("el-form-item",{attrs:{label:"",prop:"companyId"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择公司",clearable:""},on:{change:e.onChangeSearchCompany},model:{value:e.searchValidateForm.companyId,callback:function(t){e.$set(e.searchValidateForm,"companyId",t)},expression:"searchValidateForm.companyId"}},e._l(e.searchCompanyOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.COMPANY_NAME,value:e.COMPANY_ID}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"spotId"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择景区",clearable:""},on:{change:e.onChangeSearchSpot},model:{value:e.searchValidateForm.spotId,callback:function(t){e.$set(e.searchValidateForm,"spotId",t)},expression:"searchValidateForm.spotId"}},e._l(e.searchScenicOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.SPOT_NAME,value:e.SPOT_ID}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:""}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择日期统计方式"},on:{change:e.onDateChange},model:{value:e.selectDateState,callback:function(t){e.selectDateState=t},expression:"selectDateState"}},e._l(e.dateStateOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"startEndDate"}},[a("el-date-picker",{attrs:{"unlink-panels":"",type:e.dateType,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"],"value-format":e.valueFormat},model:{value:e.searchValidateForm.startEndDate,callback:function(t){e.$set(e.searchValidateForm,"startEndDate",t)},expression:"searchValidateForm.startEndDate"}})],1),a("el-form-item",{attrs:{label:"",prop:"paymentType"}},[a("el-select",{staticStyle:{"min-width":"165px"},attrs:{multiple:"","collapse-tags":"",placeholder:"请选择支付方式",clearable:""},model:{value:e.searchValidateForm.paymentType,callback:function(t){e.$set(e.searchValidateForm,"paymentType",t)},expression:"searchValidateForm.paymentType"}},e._l(e.payOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"orderStatus"}},[a("el-select",{attrs:{placeholder:"请选择支付状态",clearable:""},model:{value:e.searchValidateForm.orderStatus,callback:function(t){e.$set(e.searchValidateForm,"orderStatus",t)},expression:"searchValidateForm.orderStatus"}},e._l(e.payStateOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"real-income"},[a("span",[e._v("实际收入金额：")]),a("el-tag",{attrs:{size:"small"}},[e._v(e._s(this.realIncome))])],1),a("div",[a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.onSearch("searchValidateForm")}}},[e._v("搜索")])],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh-right"},on:{click:e.onReset}},[e._v("重置")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-view\n"},on:{click:e.onPreview}},[e._v("预览")]),a("el-button",{attrs:{type:"primary",loading:e.downloadLoading,icon:"el-icon-top-right"},on:{click:e.exportExcel}},[e._v("导出Excel")])],1),a("el-main",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","header-cell-style":{background:"#f2f2f2",color:"#606266",height:"38px",padding:"0px"},"cell-style":{height:"38px",padding:"0"}}},e._l(e.tableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t,"min-width":"130"}})})),1),a("el-table",{staticClass:"table",staticStyle:{width:"100%",display:"none"},attrs:{id:"outTable",data:e.exportTableData,border:""}},e._l(e.tableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t,"min-width":"130",align:"center"}})})),1)],1),a("el-footer",[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total, sizes, jumper",total:e.total,"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize},on:{"current-change":e.onCurrentChange,"size-change":e.onSizeChange}})],1)]),a("el-dialog",{staticClass:"pdf-dialog",attrs:{title:"流水对账单",visible:e.pdfDialogVisible,"before-close":e.handleClose,center:"",fullscreen:""},on:{"update:visible":function(t){e.pdfDialogVisible=t}}},[a("pdf-stream-account",{attrs:{propData:e.previewData,searchValidateForm:e.searchValidateForm}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.pdfDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.pdfDialogVisible=!1}}},[e._v("确 定")])],1)],1)],1)],1)},c=[],d=a("1da1"),p=(a("96cf"),a("a9e3"),a("d81d"),a("a15b"),a("d3b7"),a("25f0"),a("4de4"),a("159b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pdf-container"},[a("div",{staticClass:"pdf-operate-btn"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-download",loading:e.downloadLoading},on:{click:e.onDownloadPDF}},[e._v("下载")]),"1"==e.verifyState?a("el-tag",[e._v("已核实")]):e._e(),"2"==e.verifyState?a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-check\n"},on:{click:e.onVerify}},[e._v("核实")]):e._e()],1),a("a",{attrs:{href:e.pdfUrl,download:e.pdfName,id:"a_pdf"}}),a("div",{ref:"tableContent"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.pdfTopTableData,border:"","show-header":!1,"row-style":e.topRowStyle}},e._l(e.pdfTopTableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t}})})),1),a("el-table",{staticStyle:{width:"100%","border-top":"none"},attrs:{data:e.pdfAccountTableData,border:"","show-header":!1,"span-method":e.accountSpanMethod}},e._l(e.pdfAccountTableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t}})})),1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","border-top":"none"},attrs:{data:e.pdfTableData,border:""}},e._l(e.pdfTableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t,align:"center"}})})),1),a("el-table",{staticStyle:{width:"100%","border-top":"none"},attrs:{data:e.pdfMergeTableData,"span-method":e.arraySpanMethod,border:"","show-header":!1,"row-style":e.rowStyle}},e._l(e.pdfTableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t,align:"center"}})})),1),a("el-table",{staticStyle:{width:"100%","border-top":"none"},attrs:{data:e.pdfRowMergeTableData,border:"","show-header":!1,"row-style":e.rowStyle}},e._l(e.pdfRowTableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t,align:"center"}})})),1),a("el-table",{staticStyle:{width:"100%","border-top":"none"},attrs:{data:e.pdfTwoFlankTableData,border:"","show-header":!1}},e._l(e.pdfTwoFlankTableFields,(function(t,n){return a("el-table-column",{key:n,attrs:{prop:t,label:n},scopedSlots:e._u([{key:"default",fn:function(n){return[a("div",["dataMatch"==t?[a("div",{staticClass:"data-text"},[e._v(e._s(n.row.dataMatch))]),a("div",{staticClass:"content-text"}),a("div",{staticClass:"company-sign"},[a("div",[e._v("（公司签章）")]),a("div",{staticClass:"manager"},[e._v("经办人：")]),a("div",[e._v("年　　月　　日")])])]:"dataNoMatch"==t?[a("div",{staticClass:"data-text"},[e._v(e._s(n.row.dataNoMatch))]),a("div",{staticClass:"content-text"}),a("div",{staticClass:"company-sign"},[a("div",[e._v("（公司签章）")]),a("div",{staticClass:"manager"},[e._v("经办人：")]),a("div",[e._v("年　　月　　日")])])]:e._e()],2)]}}],null,!0)})})),1),a("el-table",{staticStyle:{width:"100%","border-top":"none"},attrs:{data:e.pdfExplainTableData,border:"","show-header":!1}},e._l(e.pdfExplainTableFields,(function(t,n){return a("el-table-column",{key:n,attrs:{prop:t,label:n},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"explain"},[a("div",{staticStyle:{width:"100%"}},[e._v(e._s(t.row.explain))]),a("div",{staticClass:"explain-footer"},[a("div",[e._v(e._s(e.footerData.companyName))]),a("div",[e._v(e._s(e.footerData.date))])])])]}}],null,!0)})})),1)],1)])}),u=[];a("99af"),a("4d90");function h(){var e=(new Date).getFullYear().toString(),t=((new Date).getMonth()+1).toString().padStart(2,"0"),a=e+"-"+t;return a}function m(){var e=(new Date).getFullYear().toString(),t=((new Date).getMonth()+1).toString().padStart(2,"0"),a=(new Date).getDate().toString().padStart(2,"0"),n=e+"年"+t+"月"+a+"日";return n}var f={name:"PdfStreamAccount",props:{propData:{type:Object,required:!0},searchValidateForm:{type:Object,required:!0}},data:function(){return{loading:!1,downloadLoading:!1,pdfUrl:"",pdfName:"",pdfTopTableFields:{"表格内容":"content"},pdfTopTableData:[{content:"平遥古城景区管理有限公司："},{content:"为了保证会计数据的准确性、及时性，依据后台管理系统订单数据，现将对账期间内与贵公司尚未结算的月度数据列示，如与贵公司核算数据相符，请在本函下方“数据相符”处盖章，如有不符请在“数据不符”处列明不符内容并签章。"}],pdfAccountTableFields:{"字段名称":"fieldName","数据名称":"dataName","字段1":"field1","字段2":"field2","字段3":"field3","字段4":"field4"},pdfAccountTableData:[{fieldName:"收款账户",dataName:"平遥古城景区管理有限公司"},{fieldName:"收款账号",dataName:"0508 0144 0920 0102 334"},{fieldName:"开 户 行",dataName:"中国工商银行股份有限公司平遥支行"}],pdfTableFields:{"系统中景区名称":"scenicName","月份":"month","流水":"stream","手续费0.6%":"tencnetFee","可分润金额(扣0.6%)":"canFenRunAmount","分润金额(扣0.6%)":"fenRunAmount"},pdfTableData:[{scenicName:"平遥古城",month:"2020年5月",stream:"103356.00",tencnetFee:"620.14",canFenRunAmount:"102735.86",fenRunAmount:"20547.17"}],pdfMergeTableData:[{scenicName:"分润比例：",month:"",stream:"",tencnetFee:"",canFenRunAmount:"",fenRunAmount:"20%"}],pdfRowTableFields:{"公式":"equation"},pdfRowMergeTableData:[{equation:"付款金额=实际结算金额（不含税）+收到的增值税专用发票税额或=分润金额+代交税率x%的增值税税额"}],pdfTwoFlankTableFields:{"数据相符":"dataMatch","数据不符":"dataNoMatch"},pdfTwoFlankTableData:[{dataMatch:"1、数据相符，核对无误。",dataNoMatch:"2、数据不符，以下为不符内容："}],pdfExplainTableFields:{"说明":"explain"},pdfExplainTableData:[{explain:"请贵公司尽快核对，并将已签章对账单反馈给我公司负责对账人员。我公司已代扣代缴6%税率的增值税款，贵公司需提供等税率的增值税专用发票，我公司将在收到核对相符的对账单及增值税专用发票后，安排支付增值税发票上的价税合计金额。"}],footerData:{companyName:"平遥九星科技有限公司",date:"2021年9月3日"},verifyState:"2"}},created:function(){this.getVerifyState()},mounted:function(){},methods:{getVerifyState:function(){var e="2";"1"==e?(console.log("已核实"),this.verifyState="1"):"2"==e&&(console.log("未核实"),this.verifyState="2")},onDownloadPDF:function(){var e=this,t=this.searchValidateForm.companyId;""!=t&&t||(t=null);var a=this.searchValidateForm.spotId;""!=a&&a||(a=null);var n,r,o=this.searchValidateForm.startEndDate;""!=o&&o?(n=this.searchValidateForm.startEndDate[0],r=this.searchValidateForm.startEndDate[1]):(n=formatMonth(),r=formatMonth());var i=this.searchValidateForm.paymentType;""!=i&&i?(i.map((function(e,t){"1"==e&&(i[t]="WECHAT"),"2"==e&&(i[t]="SAVING"),"3"==e&&(i[t]="SAVING_WECHAT"),"4"==e&&(i[t]="DEPOSIT")})),i=i.join(",")):i=null,this.downloadLoading=!0,this.pdfUrl="/system/account_statement/download?company=".concat(t,"&spot=").concat(a,"&beginDate=").concat(n,"&endDate=").concat(r,"&paymentType=").concat(i),this.pdfName="流水对账单",this.$nextTick((function(){document.getElementById("a_pdf").click(),e.downloadLoading=!1}))},onVerify:function(){console.log("点击了核实按钮")},getPdfTableData:function(){var e=this;this.loading=!0,setTimeout((function(){var t=[{scenicName:"平遥古城",month:"2020年5月",stream:"103356.00",tencnetFee:"620.14",canFenRunAmount:"102735.86",fenRunAmount:"20547.17"},{scenicName:"平遥古城",month:"2020年5月",stream:"103356.00",tencnetFee:"620.14",canFenRunAmount:"102735.86",fenRunAmount:"20547.17"},{scenicName:"平遥古城",month:"2020年5月",stream:"103356.00",tencnetFee:"620.14",canFenRunAmount:"102735.86",fenRunAmount:"20547.17"}];e.pdfTableData=t,e.loading=!1}),1e3)},topRowStyle:function(e){e.row;var t=e.rowIndex;if(0==t)return{"font-weight":"800"}},accountSpanMethod:function(e){e.row,e.column,e.rowIndex;var t=e.columnIndex;if(1===t)return[1,5]},arraySpanMethod:function(e){e.row,e.column;var t=e.rowIndex,a=e.columnIndex;return 0===a?[1,2]:1===a?[0,0]:2===t&&2===a?[1,3]:2!==t||3!==a&&4!==a?void 0:[0,0]},rowStyle:function(e){e.row,e.rowIndex;return{"font-weight":"800"}}},watch:{propData:function(e,t){if(e!==t){if(!this.propData)return;this.pdfTopTableData[0].content=this.propData.收款账户+"：",this.pdfAccountTableData[0].dataName=this.propData.收款账户,this.pdfAccountTableData[1].dataName=this.propData.收款账号,this.pdfAccountTableData[2].dataName=this.propData.开户行,this.pdfTableData=[{scenicName:this.propData.景区名称,month:this.propData.月份,stream:this.propData.流水,tencnetFee:this.propData.手续费,canFenRunAmount:this.propData.可分润金额,fenRunAmount:this.propData.分润金额}],this.pdfMergeTableData[0].fenRunAmount=this.propData.分润比例,this.footerData.companyName=this.propData.合作主体,this.footerData.date=m()}},searchValidateForm:function(e,t){e===t||this.searchValidateForm}}},b=f,y=(a("5dce"),a("2877")),g=Object(y["a"])(b,p,u,!1,null,"49db005a",null),v=g.exports,D=a("21a6"),S=a.n(D),F=a("1146"),w=a.n(F),T={name:"StreamAccount",data:function(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,a,n){a||n(),Number(a)?n():n(new Error(e+"必须为数字值"))}}return{tableLoading:!0,tableFields:{"订单编号":"orderNumber","用户手机号":"currentUserPhone","设备编号":"orderRobotCode","景区名称":"orderScenicSpotName","开始时间":"orderStartTime","结束时间":"orderEndTime","使用分钟":"totalTime","实际计费":"actualAmount","调度费":"dispatchingFee","实际支付金额":"orderAmount","退款金额":"orderRefundAmount","实际收入金额":"realIncome","支付状态":"orderStatus","支付方式":"paymentMethod"},tableData:[],searchCompanyOptions:[],searchScenicOptions:[],dateStateOptions:[{value:"1",label:"按月查询"},{value:"2",label:"按日查询"}],payOptions:[{value:"1",label:"微信支付"},{value:"2",label:"储值支付"},{value:"3",label:"微信+储值抵扣"},{value:"4",label:"押金抵扣"}],payStateOptions:[{value:"10",label:"进行中"},{value:"20",label:"未付款"},{value:"30",label:"已付款"},{value:"40",label:"交易关闭"},{value:"50",label:"免单"},{value:"60",label:"全额退款"}],exportTableData:[],downloadLoading:!1,currentPage:1,pageSize:10,selectDateState:"1",dateType:"monthrange",valueFormat:"yyyy-MM",searchValidateForm:{companyId:"",spotId:"",startEndDate:"",paymentType:"",orderStatus:""},searchVF:{companyId:"",spotId:"",startEndDate:"",paymentType:"",orderStatus:""},validateForm:{},pdfDialogVisible:!1,previewData:{},searchValidateFormRules:{realIncome:[{validator:e("实际总收入金额"),trigger:["blur","change"]}]},total:0,realIncome:""}},created:function(){this.getValidateForm(),this.getCompanyList(),this.getScenicList(),this.initTableData()},mounted:function(){},methods:{getValidateForm:function(){var e={};for(var t in this.tableFields)e[this.tableFields[t]]="";this.validateForm=e},login:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/loginSystem?username=lijiazhao&password=lijiazhao");case 2:a=t.sent,a.data;case 4:case"end":return t.stop()}}),t)})))()},getCompanyList:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=null),a.next=3,t.$http.get("/system/account_statement/companyList",{params:{spotId:e}});case 3:if(n=a.sent,r=n.data,"200"!=r.state){a.next=10;break}return t.searchCompanyOptions=r.data,a.abrupt("return",r);case 10:return a.abrupt("return");case 11:case"end":return a.stop()}}),a)})))()},getScenicList:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=null),a.next=3,t.$http.get("/system/subscriptionInformation/spotList",{params:{companyId:e}});case 3:if(n=a.sent,r=n.data,"200"!=r.state){a.next=10;break}return t.searchScenicOptions=r.data,a.abrupt("return",r);case 10:return a.abrupt("return");case 11:case"end":return a.stop()}}),a)})))()},initTableData:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var a,n,r,o,i,s,l,c,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.searchVF.companyId,""!=a&&a||(a=null),n=e.searchVF.spotId,""!=n&&n||(n=null),r=e.searchVF.startEndDate,""!=r&&r?(o=e.searchVF.startEndDate[0],i=e.searchVF.startEndDate[1]):(o=h(),i=h()),s=e.searchVF.paymentType,""!=s&&s?(s.map((function(e,t){"1"==e&&(s[t]="WECHAT"),"2"==e&&(s[t]="SAVING"),"3"==e&&(s[t]="SAVING_WECHAT"),"4"==e&&(s[t]="DEPOSIT")})),s=s.join(",")):s=null,l=e.searchVF.orderStatus,""!=l&&l||(l=null),e.tableLoading=!0,t.next=13,e.$http.get("/system/account_statement/list",{params:{company:a,spot:n,beginDate:o,endDate:i,paymentType:s,orderStatus:l,pageNum:(e.currentPage-1)*e.pageSize,pageSize:e.pageSize}});case 13:c=t.sent,d=c.data,e.tableData=d.data,e.total=d.total,e.realIncome=d.type,e.tableLoading=!1;case 19:case"end":return t.stop()}}),t)})))()},getPreviewTableData:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var a,n,r,o,i,s,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.searchValidateForm.companyId,""!=a&&a||(a=null),n=e.searchValidateForm.spotId,""!=n&&n||(n=null),r=e.searchValidateForm.startEndDate,""!=r&&r?(o=e.searchValidateForm.startEndDate[0],i=e.searchValidateForm.startEndDate[1]):(o=h(),i=h()),s=e.searchValidateForm.paymentType,""!=s&&s?(s.map((function(e,t){"1"==e&&(s[t]="WECHAT"),"2"==e&&(s[t]="SAVING"),"3"==e&&(s[t]="SAVING_WECHAT"),"4"==e&&(s[t]="DEPOSIT")})),s=s.join(",")):s=null,t.next=10,e.$http.get("/system/account_statement/preview",{params:{company:a,spot:n,beginDate:o,endDate:i,paymentType:s}});case 10:if(l=t.sent,c=l.data,console.log(c),c.data){t.next=16;break}return e.$message({message:"预览信息为空",type:"info"}),t.abrupt("return");case 16:e.previewData=c.data;case 17:case"end":return t.stop()}}),t)})))()},getExportTableData:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var a,n,r,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.searchValidateForm.startEndDate,""!=a&&a?(n=e.searchValidateForm.startEndDate[0],r=e.searchValidateForm.startEndDate[1]):(n=h(),r=h()),t.next=4,e.$http.get("/system/account_statement/list",{params:{beginDate:n,endDate:r}});case 4:o=t.sent,i=o.data,e.exportTableData=i.data;case 7:case"end":return t.stop()}}),t)})))()},getTableData:function(){this.searchValidateForm.companyId==this.searchVF.companyId&&this.searchValidateForm.spotId==this.searchVF.spotId&&this.selectDateState==this.searchSelectDateState&&this.searchValidateForm.startEndDate.toString()==this.searchVF.startEndDate.toString()&&this.searchValidateForm.paymentType.toString()==this.searchVF.paymentType.toString()&&this.searchValidateForm.orderStatus==this.searchVF.orderStatus||(this.searchVF.companyId=this.searchValidateForm.companyId,this.searchVF.spotId=this.searchValidateForm.spotId,this.searchSelectDateState=this.selectDateState,this.searchVF.startEndDate=this.searchValidateForm.startEndDate,this.searchVF.paymentType=this.searchValidateForm.paymentType,this.searchVF.orderStatus=this.searchValidateForm.orderStatus,console.log("调用接口"),this.initTableData())},setPaymentType:function(e){if(e){var t=this.searchScenicOptions.filter((function(t){return t.SPOT_ID==e})),a=[],n="1",r="2",o="3",i="4";1==t[0].WECHAT&&a.push(n),1==t[0].SAVING&&a.push(r),1==t[0].SAVING_WECHAT&&a.push(o),1==t[0].DEPOSIT&&a.push(i),this.searchValidateForm.paymentType=a}},onChangeSearchCompany:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var n,r,o,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.getScenicList(e);case 2:if(n=a.sent,r=n.data,t.searchScenicOptions=r,0!=r.length){a.next=9;break}return t.$message({type:"info",message:"/system/account_statement/soptList 接口返回的景区列表为空"}),t.searchValidateForm.spotId="",a.abrupt("return");case 9:o=!1,r.forEach((function(e){e.SPOT_ID!=t.searchValidateForm.spotId||(o=!0)})),i=r[0].SPOT_ID,e&&!o&&(t.searchValidateForm.spotId=i),t.setPaymentType(i);case 14:case"end":return a.stop()}}),a)})))()},onChangeSearchSpot:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var n,r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(t.searchValidateForm.paymentType=[]),a.next=3,t.getCompanyList(e);case 3:if(n=a.sent,r=n.data,t.searchCompanyOptions=r,0!=r.length){a.next=10;break}return t.$message({type:"info",message:"/system/account_statement/companyList 接口返回的公司列表为空"}),t.searchValidateForm.companyId="",a.abrupt("return");case 10:o=!1,r.forEach((function(e){e.COMPANY_ID!=t.searchValidateForm.companyId||(o=!0)})),e&&!o&&(t.searchValidateForm.companyId=r[0].COMPANY_ID),t.setPaymentType(e);case 14:case"end":return a.stop()}}),a)})))()},onDateChange:function(){console.log(this.selectDateState),"1"==this.selectDateState?(this.dateType="monthrange",this.valueFormat="yyyy-MM"):"2"==this.selectDateState&&(this.dateType="datetimerange",this.valueFormat="yyyy-MM-dd")},onSearch:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;t.searchValidateForm.orderScenicSpotName&&0==t.searchValidateForm.paymentType.length?t.$message({type:"warning",message:"请先选择支付方式"}):t.getTableData()}))},onReset:function(){this.searchValidateForm.companyId="",this.searchValidateForm.spotId="",this.selectDateState="1",this.dateType="monthrange",this.searchValidateForm.startEndDate="",this.searchValidateForm.paymentType="",this.searchValidateForm.orderStatus="",this.currentPage=1,this.pageSize=10,this.getTableData(),this.getCompanyList(),this.getScenicList()},onPreview:function(){this.searchValidateForm.companyId&&this.searchValidateForm.spotId&&"monthrange"===this.dateType&&this.searchValidateForm.startEndDate?(this.getPreviewTableData(),this.pdfDialogVisible=!0):this.$message("一次只能核对一个景区的整月对账单")},exportExcel:function(){var e=this;this.$confirm("确认导出Excel表格?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.downloadLoading=!0,t.next=3,e.getExportTableData();case 3:e.$nextTick((function(){var t={raw:!0},a=w.a.utils.table_to_book(document.querySelector("#outTable"),t),n=w.a.write(a,{bookType:"xlsx",bookSST:!0,type:"array"});try{S.a.saveAs(new Blob([n],{type:"application/octet-stream"}),"流水对账单.xlsx")}catch(r){"undefined"!==typeof console&&console.log(r,n)}return e.downloadLoading=!1,n})),e.$message({type:"success",message:"已成功导出Excel表格！"});case 5:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({type:"info",message:"已取消导出Excel表格"})}))},onCurrentChange:function(e){this.currentPage=e,this.initTableData()},onSizeChange:function(e){this.pageSize=e,this.initTableData()},handleClose:function(e){this.pdfDialogVisible=!1}},components:{PdfStreamAccount:v},computed:{}},V=T,x=(a("0f2c"),Object(y["a"])(V,l,c,!1,null,"41f9acb2",null)),_=x.exports,I={name:"App",components:{StreamAccount:_}},k=I,C=(a("5c0b"),Object(y["a"])(k,i,s,!1,null,null,null)),E=C.exports,A=a("2f62");o["default"].use(A["a"]);var O=new A["a"].Store({state:{},mutations:{},actions:{},modules:{}}),N=a("bc3a"),R=a.n(N),M=a("c8fc"),P=a.n(M);o["default"].use(r.a),R.a.defaults.withCredentials=!0,o["default"].prototype.$http=R.a,o["default"].config.productionTip=!1,o["default"].use(P.a),new o["default"]({store:O,render:function(e){return e(E)}}).$mount("#app")},"5c0b":function(e,t,a){"use strict";a("9c0c")},"5dce":function(e,t,a){"use strict";a("b4fc")},"9c0c":function(e,t,a){},b4fc:function(e,t,a){},f6b5:function(e,t,a){}});
//# sourceMappingURL=app.9756b855.js.map