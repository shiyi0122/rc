(function(e){function t(t){for(var r,s,c=t[0],i=t[1],l=t[2],d=0,p=[];d<c.length;d++)s=c[d],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&p.push(n[s][0]),n[s]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);u&&u(t);while(p.length)p.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],r=!0,c=1;c<a.length;c++){var i=a[c];0!==n[i]&&(r=!1)}r&&(o.splice(t--,1),e=s(s.s=a[0]))}return e}var r={},n={app:0},o=[];function s(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=r,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(a,r,function(t){return e[t]}.bind(null,r));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=i;o.push([1,"chunk-vendors"]),a()})({0:function(e,t){},"00c5":function(e,t,a){},1:function(e,t,a){e.exports=a("56d7")},2:function(e,t){},"24b5":function(e,t,a){},3:function(e,t){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("accessory-account")],1)},o=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"partner-company"},[a("el-container",[a("el-header",{staticClass:"header"},[a("el-form",{ref:"searchValidateForm",staticClass:"search-validate-form",attrs:{inline:!0,model:e.searchValidateForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"",prop:"company"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择公司",clearable:""},on:{change:e.onChangeSearchCompany},model:{value:e.searchValidateForm.company,callback:function(t){e.$set(e.searchValidateForm,"company",t)},expression:"searchValidateForm.company"}},e._l(e.searchCompanyOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.COMPANY_NAME,value:e.COMPANY_ID}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"spot"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择景区",clearable:""},on:{change:e.onChangeSearchSpot},model:{value:e.searchValidateForm.spot,callback:function(t){e.$set(e.searchValidateForm,"spot",t)},expression:"searchValidateForm.spot"}},e._l(e.searchScenicOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.SPOT_NAME,value:e.SPOT_ID}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"",rules:[]}},[a("el-date-picker",{attrs:{"unlink-panels":"",type:e.dateType,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM"},model:{value:e.searchStartEndDate,callback:function(t){e.searchStartEndDate=t},expression:"searchStartEndDate"}})],1),a("el-form-item",{attrs:{label:"",prop:"type",rules:[]}},[a("el-select",{staticStyle:{"min-width":"165px"},attrs:{"collapse-tags":"",placeholder:"请选择类型",clearable:""},model:{value:e.searchValidateForm.type,callback:function(t){e.$set(e.searchValidateForm,"type",t)},expression:"searchValidateForm.type"}},e._l(e.typeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"warrantyState",rules:[]}},[a("el-select",{staticStyle:{"min-width":"165px"},attrs:{"collapse-tags":"",placeholder:"请选择质保状态",clearable:""},model:{value:e.searchValidateForm.warrantyState,callback:function(t){e.$set(e.searchValidateForm,"warrantyState",t)},expression:"searchValidateForm.warrantyState"}},e._l(e.warrantyStateOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"errorRecordsUpkeepCost",rules:[{type:"number",message:"实际总收入金额必须为数字值",transform:function(e){return Number(e)}}]}},[a("el-input",{attrs:{type:"number",placeholder:"请输入配件维修费"},model:{value:e.searchValidateForm.errorRecordsUpkeepCost,callback:function(t){e.$set(e.searchValidateForm,"errorRecordsUpkeepCost",e._n(t))},expression:"searchValidateForm.errorRecordsUpkeepCost"}})],1)],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.onSearch("searchValidateForm")}}},[e._v("搜索")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh-right"},on:{click:e.onReset}},[e._v("重置")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-view\n"},on:{click:e.onPreview}},[e._v("预览")]),a("el-button",{attrs:{type:"primary",loading:e.downloadLoading,icon:"el-icon-top-right"},on:{click:e.exportExcel}},[e._v("导出Excel")])],1),a("el-main",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","header-cell-style":{background:"#f2f2f2",color:"#606266",height:"38px",padding:"0px"},"cell-style":{height:"38px",padding:"0"},"show-summary":"","summary-method":e.getSummaries}},e._l(e.tableFields,(function(t,r){return a("el-table-column",{key:r,attrs:{prop:t,label:r,"min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(r){return[a("div",[e._v(" "+e._s(e.tableContentValue(r.row,t))+" ")])]}}],null,!0)})})),1),a("el-table",{staticClass:"table",staticStyle:{width:"100%",display:"none"},attrs:{id:"outTable",data:e.exportTableData,border:"","show-summary":"","summary-method":e.getSummaries}},e._l(e.tableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t,"min-width":"130",align:"center"}})})),1)],1),a("el-footer",[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total, sizes, jumper",total:e.total,"current-page":e.currentPage,"page-sizes":[10,20,30,40,50,60,70,80,90],"page-size":e.pageSize},on:{"current-change":e.onCurrentChange,"size-change":e.onSizeChange}})],1)]),e.pdfDialogVisible?a("el-dialog",{staticClass:"pdf-dialog",attrs:{title:"配件维修对账单",visible:e.pdfDialogVisible,"before-close":e.handleClose,center:"",fullscreen:""},on:{"update:visible":function(t){e.pdfDialogVisible=t}}},[a("pdf-stream-account",{attrs:{companyId:e.searchValidateForm.company,companyName:e.searchCompanyName,spotId:e.searchValidateForm.spot,startEndDate:e.searchStartEndDate,type:e.searchValidateForm.type,warrantyState:e.searchValidateForm.warrantyState,errorRecordsUpkeepCost:e.searchValidateForm.errorRecordsUpkeepCost}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.pdfDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.pdfDialogVisible=!1}}},[e._v("确 定")])],1)],1):e._e()],1)],1)},c=[],i=a("1da1"),l=a("5530"),u=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("159b"),a("96cf"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pdf-container"},[a("div",{staticClass:"pdf-operate-btn"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-download",loading:e.downloadLoading},on:{click:e.onDownloadPDF}},[e._v("下载")]),"0"==e.verifyState?a("el-tag",[e._v("已核实")]):e._e(),"1"==e.verifyState?a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-check",loading:e.verifyLoading},on:{click:e.onVerify}},[e._v("核实")]):e._e()],1),a("div",{ref:"tableContent"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.pdfTopTableData,border:"","show-header":!1,"row-style":e.topRowStyle}},e._l(e.pdfTopTableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t}})})),1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.accountLoading,expression:"accountLoading"}],staticStyle:{width:"100%","border-top":"none"},attrs:{data:e.pdfAccountTableData,border:"","show-header":!1,"span-method":e.accountSpanMethod}},e._l(e.pdfAccountTableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t}})})),1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","border-top":"none"},attrs:{data:e.pdfTableData,border:""}},e._l(e.pdfTableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t,align:"center"}})})),1),a("el-table",{staticStyle:{width:"100%","border-top":"none"},attrs:{data:e.pdfRowMergeTableData,border:"","show-header":!1,"row-style":e.rowStyle}},e._l(e.pdfRowTableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t,align:"center"}})})),1),a("el-table",{staticStyle:{width:"100%","border-top":"none"},attrs:{data:e.pdfTwoFlankTableData,border:"","show-header":!1}},e._l(e.pdfTwoFlankTableFields,(function(t,r){return a("el-table-column",{key:r,attrs:{prop:t,label:r},scopedSlots:e._u([{key:"default",fn:function(r){return[a("div",["dataMatch"==t?[a("div",{staticClass:"data-text"},[e._v(e._s(r.row.dataMatch))]),a("div",{staticClass:"content-text"}),a("div",{staticClass:"company-sign"},[a("div",[e._v("（公司签章）")]),a("div",{staticClass:"manager"},[e._v("经办人：")]),a("div",[e._v("年　　月　　日")])])]:"dataNoMatch"==t?[a("div",{staticClass:"data-text"},[e._v(e._s(r.row.dataNoMatch))]),a("div",{staticClass:"content-text"}),a("div",{staticClass:"company-sign"},[a("div",[e._v("（公司签章）")]),a("div",{staticClass:"manager"},[e._v("经办人：")]),a("div",[e._v("年　　月　　日")])])]:e._e()],2)]}}],null,!0)})})),1),a("el-table",{staticStyle:{width:"100%","border-top":"none"},attrs:{data:e.pdfExplainTableData,border:"","show-header":!1}},e._l(e.pdfExplainTableFields,(function(t,r){return a("el-table-column",{key:r,attrs:{prop:t,label:r},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"explain"},[a("div",{staticStyle:{width:"100%"}},[e._v(e._s(t.row.explain))]),a("div",{staticClass:"explain-footer"},[a("div",[e._v(e._s(e.footerData.companyName))]),a("div",[e._v(e._s(e.footerData.date))])])])]}}],null,!0)})})),1)],1)])}),d=[];a("25f0"),a("4d90");function p(){var e=(new Date).getFullYear().toString(),t=((new Date).getMonth()+1).toString().padStart(2,"0"),a=e+"-"+t;return a}function f(){var e=(new Date).getFullYear().toString(),t=((new Date).getMonth()+1).toString().padStart(2,"0"),a=(new Date).getDate().toString().padStart(2,"0"),r=e+"年"+t+"月"+a+"日";return r}var m={name:"PdfStreamAccount",props:["companyId","companyName","spotId","startEndDate","type","warrantyState","errorRecordsUpkeepCost"],data:function(){return{loading:!1,downloadLoading:!1,verifyLoading:!1,pdfUrl:"",pdfName:"",pdfTopTableFields:{"表格内容":"content"},pdfTopTableData:[{content:"平遥古城景区管理有限公司："},{content:"为了保证会计数据的准确性、及时性，依据后台管理系统订单数据，现将对账期间内与贵公司尚未结算的月度数据列示，如与贵公司核算数据相符，请在本函下方“数据相符”处盖章，如有不符请在“数据不符”处列明不符内容并签章。"}],pdfAccountTableFields:{"字段名称":"fieldName","数据名称":"dataName"},pdfAccountTableData:[{fieldName:"收款账户",dataName:"平遥古城景区管理有限公司"},{fieldName:"收款账号",dataName:"0508 0144 0920 0102 334"},{fieldName:"开 户 行",dataName:"中国工商银行股份有限公司平遥支行"}],accountLoading:!1,pdfTableFields:{"系统中景区名称":"景区名称","月份":"月份","景区承担配件费":"配件费用","景区承担维修费":"维修费用","费用合计":"合计"},pdfTableData:[],pdfMergeTableData:[{scenicName:"分润金额小计（含税）：",month:"",accessoryApplicationFee:"103356.00",tencnetFee:"620.14",canFenRunAmount:"102735.86",fenRunAmount:"20547.17"},{scenicName:"分润比例：",month:"",accessoryApplicationFee:"",tencnetFee:"",canFenRunAmount:"",fenRunAmount:"20%"},{scenicName:"流水结算金额（不含税）：",month:"",accessoryApplicationFee:"可分润金额=流水×（1-0.6%）　\n        增值税税额=可分润金额÷（1+6 %）×6%\n        ",tencnetFee:"",canFenRunAmount:"",fenRunAmount:"19384.12"}],pdfRowTableFields:{"公式":"equation"},pdfRowMergeTableData:[{equation:"费用合计=景区承担配件费+景区承担维修费"}],pdfTwoFlankTableFields:{"数据相符":"dataMatch","数据不符":"dataNoMatch"},pdfTwoFlankTableData:[{dataMatch:"1、数据相符，核对无误。",dataNoMatch:"2、数据不符，以下为不符内容："}],pdfExplainTableFields:{"说明":"explain"},pdfExplainTableData:[{explain:"请贵公司尽快核对，并将已签章对账单反馈给我公司负责对账人员。"}],footerData:{companyName:"平遥九星科技有限公司",date:"2021年9月3日"},verifyState:"0"}},created:function(){this.pdfTopTableData[0].content=this.companyName+"：",this.pdfAccountTableData[0].dataName=this.companyName,this.footerData.companyName=this.companyName,this.footerData.date=f(),this.getAccount(),this.getPdfTableData(),this.getVerifyState()},methods:{getVerifyState:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/system/statementOfAccessories/settlementStateState",{params:{company:e.companyId,spot:e.spotId,beginDate:e.startEndDate&&e.startEndDate[0],endDate:e.startEndDate&&e.startEndDate[1],paymentType:e.type||null,warrantyState:e.warrantyState||null,errorRecordsUpkeepCost:e.errorRecordsUpkeepCost||null}});case 2:if(a=t.sent,r=a.data,200==r.state){t.next=7;break}return e.$message({type:"error",message:"请求失败！"}),t.abrupt("return");case 7:n=r.data,"0"==n?(console.log("已核实"),e.verifyState="0"):"1"==n&&(console.log("未核实"),e.verifyState="1");case 9:case"end":return t.stop()}}),t)})))()},exitSettlementState:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.verifyLoading=!0,t.next=3,e.$http.get("/system/statementOfAccessories/exitSettlementState",{params:{company:e.companyId,spot:e.spotId,beginDate:e.startEndDate,paymentType:e.type||null,warrantyState:e.warrantyState||null,errorRecordsUpkeepCost:e.errorRecordsUpkeepCost||null}});case 3:if(a=t.sent,r=a.data,200==r.state){t.next=8;break}return e.$message({type:"error",message:"请求失败！"}),t.abrupt("return");case 8:e.$message({type:"success",message:"核实成功！"}),e.verifyLoading=!1;case 10:case"end":return t.stop()}}),t)})))()},onDownloadPDF:function(){var e=this;this.$confirm("确认导出PDF文件?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.downloadLoading=!0;var t=e.$PDFOutput(e.$refs["tableContent"]);t.then((function(t){var a=document.createElement("a");a.href=t,a.download="配件维修对账单",a.click(),e.downloadLoading=!1}))})).catch((function(){e.$message({type:"info",message:"已取消导出PDF文件"})}))},onVerify:function(){+new Date(this.startEndDate)>=+new Date(p())?this.$message({type:"warning",message:"不能核实当月及大于当月的数据",offset:100,center:!0,duration:2e3}):(new Date).getDate()<=5?this.$message({type:"warning",message:"请在5号后再进行对账操作",offset:100,center:!0,duration:2e3}):this.exitSettlementState()},getAccount:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.accountLoading=!0,t.next=3,e.$http.get("/system/statementOfAccessories/getCompanyId",{params:{companyId:e.companyId}});case 3:if(a=t.sent,r=a.data,200==r.state){t.next=8;break}return e.$message({type:"error",message:"请求失败！"}),t.abrupt("return");case 8:n=r.data||{},console.log("账户数据：",n),e.pdfAccountTableData[1].dataName=n.collectionAccountNumber,e.pdfAccountTableData[2].dataName=n.bank,e.accountLoading=!1;case 13:case"end":return t.stop()}}),t)})))()},getPdfTableData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$http.get("/system/statementOfAccessories/preview",{params:{company:e.companyId,spot:e.spotId,beginDate:e.startEndDate&&e.startEndDate[0],endDate:e.startEndDate&&e.startEndDate[1],paymentType:e.type,warrantyState:e.warrantyState,errorRecordsUpkeepCost:e.errorRecordsUpkeepCost}});case 3:if(a=t.sent,r=a.data,200==r.state){t.next=8;break}return e.$message({type:"error",message:"请求失败！"}),t.abrupt("return");case 8:e.pdfTableData=r.data,e.loading=!1;case 10:case"end":return t.stop()}}),t)})))()},topRowStyle:function(e){e.row;var t=e.rowIndex;if(0==t)return{"font-weight":"800"}},accountSpanMethod:function(e){e.row,e.column,e.rowIndex;var t=e.columnIndex;if(1===t)return[1,5]},arraySpanMethod:function(e){e.row,e.column;var t=e.rowIndex,a=e.columnIndex;return 0===a?[1,2]:1===a?[0,0]:2===t&&2===a?[1,3]:2!==t||3!==a&&4!==a?void 0:[0,0]},rowStyle:function(e){e.row,e.rowIndex;return{"font-weight":"800"}}}},h=m,b=(a("ffdd"),a("2877")),g=Object(b["a"])(h,u,d,!1,null,"4940dfec",null),y=g.exports,v=(a("21a6"),a("1146"),{name:"AccessoryAccount",data:function(){return{tableLoading:!1,tableFields:{"类型":"type","景区名称":"scenicSpotName","申请人":"userName","申请时间":"applyTime","确认时间":"confirmTime","配件名称":"accessoryName","配件数量":"errorRecordsNumber","是否使用新配件":"errorRecordsReplace","配件是否过保":"warrantyState","运营不当造成":"improperOperation","配件是否签收":"errorRecordsReceive","配件价格/元":"errorRecordsPartPrice","维修费用/元":"errorRecordsUpkeepCost","维修状态":"serviceRecordsResult","配件费用/元":"accessoryFee","(运营+景区)承担配件费/元":"spotPartsCost","(运营+景区)承担维修费/元":"spotRepairCost","关联单号":"关联单号字段","结算状态":"settleState"},tableData:[],calculateTotalData:{},searchCompanyOptions:[],searchScenicOptions:[],dateStateOptions:[{value:"1",label:"按月查询"},{value:"2",label:"按日查询"},{value:"3",label:"按年查询"}],typeOptions:[{value:"1",label:"配件申请"},{value:"2",label:"故障上报"},{value:"3",label:"损坏赔偿"}],warrantyStateOptions:[{value:"1",label:"在质保期"},{value:"2",label:"不在质保期"}],exportTableData:[],downloadLoading:!1,total:0,currentPage:1,pageSize:10,selectDateState:"1",dateType:"monthrange",searchValidateForm:{},validateForm:{},searchCompanyName:"",searchScenicName:"",searchStartEndDate:"",searchAccessoryType:"",searchWarrantyState:"",searchMaintenanceFee:"",pdfDialogVisible:!1}},created:function(){this.getSearchValidateForm(),this.initTableData(),this.getCompanyList(),this.getScenicList()},mounted:function(){},methods:{getSearchValidateForm:function(){var e={};for(var t in this.tableFields)e[this.tableFields[t]]="";this.searchValidateForm=Object(l["a"])(Object(l["a"])({},e),{},{company:"",spot:""})},login:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/loginSystem?username=lijiazhao&password=lijiazhao");case 2:a=t.sent,a.data;case 4:case"end":return t.stop()}}),t)})))()},getCompanyList:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=null),a.next=3,t.$http.get("/system/subscriptionInformation/companyList",{params:{spotId:e}});case 3:if(r=a.sent,n=r.data,"200"!=n.state){a.next=10;break}return t.searchCompanyOptions=n.data,a.abrupt("return",n);case 10:return a.abrupt("return");case 11:case"end":return a.stop()}}),a)})))()},getScenicList:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=null),a.next=3,t.$http.get("/system/subscriptionInformation/spotList",{params:{companyId:e}});case 3:if(r=a.sent,n=r.data,"200"!=n.state){a.next=10;break}return t.searchScenicOptions=n.data,a.abrupt("return",n);case 10:return a.abrupt("return");case 11:case"end":return a.stop()}}),a)})))()},getCalculateTotal:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/system/statementOfAccessories/calculateTotal",{params:Object(l["a"])(Object(l["a"])({},e.searchValidateForm),{},{beginDate:e.searchStartEndDate&&e.searchStartEndDate[0],endDate:e.searchStartEndDate&&e.searchStartEndDate[1],paymentType:e.searchValidateForm.type,pageNum:e.currentPage,pageSize:e.pageSize})});case 2:if(a=t.sent,r=a.data,200==r.state){t.next=7;break}return e.$message({type:"error",message:"请求失败！"}),t.abrupt("return");case 7:e.calculateTotalData=r.data||{};case 8:case"end":return t.stop()}}),t)})))()},initTableData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.next=3,e.$http.get("/system/statementOfAccessories/list",{params:Object(l["a"])(Object(l["a"])({},e.searchValidateForm),{},{beginDate:e.searchStartEndDate&&e.searchStartEndDate[0],endDate:e.searchStartEndDate&&e.searchStartEndDate[1],paymentType:e.searchValidateForm.type,pageNum:e.currentPage,pageSize:e.pageSize})});case 3:if(a=t.sent,r=a.data,200==r.state){t.next=8;break}return e.$message({type:"error",message:"请求失败！"}),t.abrupt("return");case 8:e.tableData=r.data,e.total=r.total,e.getCalculateTotal(),e.tableLoading=!1;case 12:case"end":return t.stop()}}),t)})))()},getExportTableData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/system/statementOfAccessories/download",{params:{},responseType:"arraybuffer"});case 2:a=t.sent,r=a.data,n=window.URL.createObjectURL(new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),o=document.createElement("a"),console.log(n),o.href=n,o.download="配件对账单",o.click(),e.downloadLoading=!1;case 11:case"end":return t.stop()}}),t)})))()},onChangeSearchCompany:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n,o,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(t.searchCompanyName=""),t.searchCompanyOptions.forEach((function(a){a.COMPANY_ID==e&&(t.searchCompanyName=a.COMPANY_NAME)})),a.next=4,t.getScenicList(e);case 4:if(r=a.sent,n=r.data,t.searchScenicOptions=n,0!=n.length){a.next=10;break}return t.searchValidateForm.spot="",a.abrupt("return");case 10:o=!1,n.forEach((function(e){e.SPOT_ID!=t.searchValidateForm.spot||(o=!0)})),s=n[0].SPOT_ID,e&&!o&&(t.searchValidateForm.spot=s);case 14:case"end":return a.stop()}}),a)})))()},onChangeSearchSpot:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.getCompanyList(e);case 2:if(r=a.sent,n=r.data,0!=n.length){a.next=7;break}return t.searchValidateForm.company="",a.abrupt("return");case 7:o=!1,n.forEach((function(e){e.COMPANY_ID!=t.searchValidateForm.company||(o=!0)})),e&&!o&&(t.searchValidateForm.company=n[0].COMPANY_ID,t.searchCompanyName=n[0].COMPANY_NAME);case 10:case"end":return a.stop()}}),a)})))()},onDateChange:function(){console.log(this.selectDateState),"1"==this.selectDateState?this.dateType="monthrange":"2"==this.selectDateState?this.dateType="daterange":"3"==this.selectDateState&&(this.dateType="yearrange")},onSearch:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;t.initTableData()}))},onReset:function(){this.getSearchValidateForm(),this.searchStartEndDate="",this.currentPage=1,this.initTableData(),this.getCompanyList(),this.getScenicList()},onPreview:function(){this.searchStartEndDate&&this.searchValidateForm.company&&this.searchValidateForm.spot?this.pdfDialogVisible=!0:this.$message({type:"warning",message:"一次只能核对一个景区的整月对账单",offset:100,center:!0,duration:1e3})},exportExcel:function(){var e=this;this.$confirm("确认导出Excel表格?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.downloadLoading=!0,t.next=3,e.getExportTableData();case 3:e.$message({type:"success",message:"已成功导出Excel表格！",offset:100,center:!0,duration:1e3});case 4:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({type:"info",message:"已取消导出Excel表格",offset:100,center:!0,duration:1e3})}))},getSummaries:function(e){var t=this,a=e.columns,r=(e.data,[]);return a.forEach((function(e,a){0===a&&(r[a]="合计"),"errorRecordsUpkeepCost"==e.property&&(r[a]=t.calculateTotalData.totalMaintenanceCost+"元"),"accessoryFee"==e.property&&(r[a]=t.calculateTotalData.totalCostOfAccessories+"元"),"spotPartsCost"==e.property&&(r[a]=t.calculateTotalData.spotBearPartsCost+"元"),"spotRepairCost"==e.property&&(r[a]=t.calculateTotalData.spotBearrepairCost+"元")})),r},onCurrentChange:function(e){this.currentPage=e,this.initTableData()},onSizeChange:function(e){this.pageSize=e,this.initTableData()},handleClose:function(e){this.pdfDialogVisible=!1}},components:{PdfStreamAccount:y},computed:{tableContentValue:function(){return function(e,t){var a="";return"type"==t?1==e[t]?a="配件申请":2==e[t]?a="故障上报":3==e[t]&&(a="损坏赔偿"):"errorRecordsReplace"==t||"errorRecordsReceive"==t?0==e[t]?a="否":1==e[t]&&(a="是"):"serviceRecordsResult"==t?1==e[t]?a="未维修":2==e[t]?a="已修好，远程协助":3==e[t]?a="已判断问题，需要配件":4==e[t]?a="未修好，需要售后现场解决":5==e[t]?a="已修好，售后现场解决":6==e[t]?a="已确认修好":7==e[t]&&(a="已关闭"):a=e[t],a}}}}),w=v,S=(a("789f"),Object(b["a"])(w,s,c,!1,null,"59a5b7e6",null)),D=S.exports,x={name:"App",components:{AccessoryAccount:D}},C=x,T=(a("5c0b"),Object(b["a"])(C,n,o,!1,null,null,null)),k=T.exports,F=a("2f62");r["default"].use(F["a"]);var R=new F["a"].Store({state:{},mutations:{},actions:{},modules:{}}),_=(a("46a1"),a("450d"),a("e5f2")),O=a.n(_),N=(a("9e1f"),a("6ed5")),V=a.n(N),E=(a("0fb7"),a("f529")),A=a.n(E),$=(a("f4f9"),a("c2cc")),P=a.n($),j=(a("7a0f"),a("0f6c")),M=a.n(j),L=(a("cbb5"),a("8bbc")),I=a.n(L),U=(a("be4f"),a("896a")),z=a.n(U),Y=(a("826b"),a("c263")),B=a.n(Y),q=(a("3db2"),a("58b8")),J=a.n(q),W=(a("eca7"),a("3787")),G=a.n(W),H=(a("425f"),a("4105")),K=a.n(H),Q=(a("a7cc"),a("df33")),X=a.n(Q),Z=(a("672e"),a("101e")),ee=a.n(Z),te=(a("5466"),a("ecdf")),ae=a.n(te),re=(a("38a0"),a("ad41")),ne=a.n(re),oe=(a("10cb"),a("f3ad")),se=a.n(oe),ce=(a("bdc7"),a("aa2f")),ie=a.n(ce),le=(a("de31"),a("c69e")),ue=a.n(le),de=(a("a673"),a("7b31")),pe=a.n(de),fe=(a("adec"),a("3d2d")),me=a.n(fe),he=(a("6611"),a("e772")),be=a.n(he),ge=(a("1f1a"),a("4e4b")),ye=a.n(ge),ve=(a("1951"),a("eedf")),we=a.n(ve);r["default"].use(we.a),r["default"].use(ye.a),r["default"].use(be.a),r["default"].use(me.a),r["default"].use(pe.a),r["default"].use(ue.a),r["default"].use(ie.a),r["default"].use(se.a),r["default"].use(ne.a),r["default"].use(ae.a),r["default"].use(ee.a),r["default"].use(X.a),r["default"].use(K.a),r["default"].use(G.a),r["default"].use(J.a),r["default"].use(B.a),r["default"].use(z.a),r["default"].use(I.a),r["default"].use(M.a),r["default"].use(P.a),r["default"].prototype.$message=A.a,r["default"].prototype.$confirm=V.a.confirm,r["default"].prototype.$notify=O.a;var Se=a("bc3a"),De=a.n(Se),xe=a("c8fc"),Ce=a.n(xe);De.a.defaults.withCredentials=!0,r["default"].prototype.$http=De.a,r["default"].config.productionTip=!1,r["default"].use(Ce.a),new r["default"]({store:R,render:function(e){return e(k)}}).$mount("#app")},"5c0b":function(e,t,a){"use strict";a("9c0c")},"789f":function(e,t,a){"use strict";a("00c5")},"9c0c":function(e,t,a){},ffdd:function(e,t,a){"use strict";a("24b5")}});
//# sourceMappingURL=app.ce07f821.js.map