(function(e){function t(t){for(var r,s,i=t[0],l=t[1],c=t[2],d=0,h=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&h.push(n[s][0]),n[s]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(h.length)h.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],r=!0,i=1;i<a.length;i++){var l=a[i];0!==n[l]&&(r=!1)}r&&(o.splice(t--,1),e=s(s.s=a[0]))}return e}var r={},n={index:0},o=[];function s(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=r,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(a,r,function(t){return e[t]}.bind(null,r));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=l;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0f14":function(e,t,a){"use strict";a("2ce1")},"164e":function(e,t){e.exports=echarts},"2ce1":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("8bbf"),n=a.n(r),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("robot-spot-statistics-amount")],1)},s=[],i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"partner-company"},[a("el-container",[a("el-header",{staticClass:"header"},[a("el-form",{ref:"searchValidateForm",staticClass:"search-validate-form",attrs:{inline:!0,model:e.searchValidateForm,"label-width":"100px",rules:e.searchValidateFormRules}},[a("el-form-item",{attrs:{label:"",prop:"companyId"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择公司",clearable:""},on:{change:e.onChangeSearchCompany},model:{value:e.searchValidateForm.companyId,callback:function(t){e.$set(e.searchValidateForm,"companyId",t)},expression:"searchValidateForm.companyId"}},e._l(e.searchCompanyOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.COMPANY_NAME,value:e.COMPANY_ID}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"spotId"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择景区",clearable:""},on:{change:e.onChangeSearchSpot},model:{value:e.searchValidateForm.spotId,callback:function(t){e.$set(e.searchValidateForm,"spotId",t)},expression:"searchValidateForm.spotId"}},e._l(e.searchScenicOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.SCENIC_SPOT_NAME,value:e.SCENIC_SPOT_ID}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"type"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择统计方式"},on:{change:e.onChangeType},model:{value:e.searchValidateForm.type,callback:function(t){e.$set(e.searchValidateForm,"type",t)},expression:"searchValidateForm.type"}},e._l(e.typeOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"selectDateState"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择日期统计方式"},on:{change:e.onDateChange},model:{value:e.searchValidateForm.selectDateState,callback:function(t){e.$set(e.searchValidateForm,"selectDateState",t)},expression:"searchValidateForm.selectDateState"}},e._l(e.dateStateOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{staticStyle:{width:"350px"},attrs:{label:"",prop:"startEndDate"}},[a("el-date-picker",{attrs:{"unlink-panels":"",type:e.dateType,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.searchValidateForm.startEndDate,callback:function(t){e.$set(e.searchValidateForm,"startEndDate",t)},expression:"searchValidateForm.startEndDate"}})],1),a("el-form-item",{attrs:{label:"",prop:"payType"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择支付方式",clearable:""},model:{value:e.searchValidateForm.payType,callback:function(t){e.$set(e.searchValidateForm,"payType",t)},expression:"searchValidateForm.payType"}},e._l(e.payTypeOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"status"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择景区运营状态",clearable:""},model:{value:e.searchValidateForm.status,callback:function(t){e.$set(e.searchValidateForm,"status",t)},expression:"searchValidateForm.status"}},e._l(e.statusOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"amountType"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择金额类型",disabled:e.disabledAmountType},on:{change:e.onChangeAmountType},model:{value:e.searchValidateForm.amountType,callback:function(t){e.$set(e.searchValidateForm,"amountType",t)},expression:"searchValidateForm.amountType"}},e._l(e.amountTypeOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"realAmount"}},[a("el-input",{attrs:{placeholder:"请输入交易金额"},model:{value:e.searchValidateForm.realAmount,callback:function(t){e.$set(e.searchValidateForm,"realAmount",t)},expression:"searchValidateForm.realAmount"}})],1)],1),a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh-right"},on:{click:e.onReset}},[e._v("重置内容")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-data-line",disabled:e.disabledStatGrossProfit},on:{click:function(t){return e.onStatGrossProfit("searchValidateForm")}}},[e._v("刷新报表")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-data-line",disabled:e.disabledStatGrossProfit},on:{click:function(t){return e.onStatGrossProfit("searchValidateForm")}}},[e._v("统计报表")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-pie-chart",disabled:e.disabledStatPayWay},on:{click:function(t){return e.onStatPayWay("searchValidateForm")}}},[e._v("统计支付方式")]),a("a",{attrs:{href:"",id:"exportReport",download:"按景区统计运营流水"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-s-data"},on:{click:e.onExportReport}},[e._v("导出报表")])],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.onSearch("searchValidateForm")}}},[e._v("查询数据")]),a("el-button",{attrs:{type:"primary",loading:e.downloadLoading,icon:"el-icon-top-right"},on:{click:e.exportExcel}},[e._v("导出数据")])],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showTable,expression:"showTable"}]},[a("el-main",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","default-sort":{prop:"realAmount",order:"descending"},"header-cell-style":{background:"#f2f2f2",color:"#606266",height:"38px",padding:"0px"},"cell-style":{height:"38px",padding:"0"},"show-summary":"","summary-method":e.getSummaries},on:{"sort-change":e.onSortChange}},[e._l(e.tableFields,(function(t,r){return[a("el-table-column",{key:r,attrs:{prop:t,label:r,"min-width":"130",fixed:e.activeFixed(t),sortable:e.sortable(t)},scopedSlots:e._u([{key:"default",fn:function(r){return[a("div",[e._v(" "+e._s(e.tableContentValue(r.row,t))+" ")])]}}],null,!0)})]}))],2),a("el-table",{staticClass:"table",staticStyle:{width:"100%",display:"none"},attrs:{id:"outTable",data:e.exportTableData,border:"","show-summary":"","summary-method":e.getSummaries}},e._l(e.tableFields,(function(t,r){return a("el-table-column",{key:r,attrs:{prop:t,label:r,"min-width":"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){return[a("div",[e._v(" "+e._s(e.tableContentValue(r.row,t))+" ")])]}}],null,!0)})})),1)],1),a("el-footer",[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total, sizes, jumper",total:e.total,"current-page":e.currentPage,"page-sizes":[10,20,30,40,50,60,70,80,90,100],"page-size":e.pageSize},on:{"current-change":e.onCurrentChange,"size-change":e.onSizeChange}})],1)])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showBarChart,expression:"showBarChart"}],staticClass:"my-echarts"},[a("div",{attrs:{id:"myChart"}})]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showPieChart,expression:"showPieChart"}],staticClass:"my-echarts"},[a("div",{attrs:{id:"myPieChart"}})]),a("div")],1)],1)},l=[],c=a("ade3"),u=a("1da1");a("96cf"),a("a9e3"),a("99af"),a("159b"),a("b0c0"),a("07ac"),a("a434"),a("b64b"),a("7db0"),a("d81d"),a("d3b7"),a("25f0"),a("4d90");function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",a=e.getFullYear().toString(),r=(e.getMonth()+1).toString().padStart(2,"0"),n=e.getDate().toString().padStart(2,"0"),o="";return"1"==t?o=a+"-"+r+"-"+n:"2"==t?o=a+"-"+r:"3"==t&&(o=a),o}var h={name:"ScenicProfitStatistic",data:function(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,a,r){a||r(),isNaN(Number(a))?r(new Error(e+"必须为数字值")):r()}}function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,a,r){if(!a)return r(new Error(e+"不能为空"));r()}}return{showTable:!1,showBarChart:!0,showPieChart:!1,feeInput:"",taxInput:"",searchFeeInput:"",searchTaxInput:"",tableFields:{"起止时间":"checkDate","景区名称":"spotName","交易金额/元":"realAmount","同比":"tb","环比":"hb","平均单台交易金额/元":"avgsc","运营时长/小时":"yysc","平均单台运营时长/小时":"avgyysc","在线订单数":"jxz","无营收天数":"wuyingshou"},tableData:[],searchTableFields:{"时间":"checkDate","景区名称":"spotName","交易金额/元":"realAmount","同比":"tb","环比":"hb","平均单台交易金额/元":"avgsc","运营时长/小时":"yysc","平均单台运营时长/小时":"avgyysc","在线订单数":"jxz","无营收天数":"wuyingshou"},tableLoading:!1,searchCompanyOptions:[],searchScenicOptions:[],dateStateOptions:[{value:"1",label:"按日查询"},{value:"2",label:"按月查询"},{value:"3",label:"按年查询"}],typeOptions:[{value:"1",label:"按景区统计"},{value:"2",label:"按机器人统计"}],statusOptions:[{value:"1",label:"已运营景区"},{value:"2",label:"测试景区"},{value:"3",label:"预运营景区"}],payTypeOptions:[{value:"1",label:"微信支付"},{value:"2",label:"储值支付"},{value:"3",label:"微信+储值"},{value:"4",label:"押金抵扣"}],amountTypeOptions:[{value:"1",label:"交易金额"},{value:"2",label:"平均交易金额"}],exportTableData:[],downloadLoading:!1,currentPage:1,pageSize:100,dialogVisible:!1,dialogState:"",dateType:"daterange",valueFormat:"yyyy-MM-dd",searchValidateForm:{companyId:"",spotId:"",type:"1",selectDateState:"1",startEndDate:[new Date,new Date],payType:"",status:"1",amountType:"1",realAmount:"",robotCode:""},validateForm:{},companys:[],companyState:"",scenics:[],scenicState:"",total:0,order:"realAmount desc",echartsOrder:null,myChart:null,option:{},myPieChart:null,pieOption:{},disabledStatGrossProfit:!1,disabledStatPayWay:!1,disabledAmountType:!1,searchValidateFormRules:{startEndDate:[{validator:t("起止时间"),required:!0,trigger:["blur","change"]}],realAmount:[{validator:e("交易金额"),trigger:["blur","change"]}]},validateFormRules:{}}},created:function(){this.getValidateForm(),this.initTableData(),this.getCompanyList(),this.getScenicList()},mounted:function(){this.drawEcharts(),this.drawPieEcharts(),this.initEchartsData()},methods:{getValidateForm:function(){var e={};for(var t in this.tableFields)e[this.tableFields[t]]="";this.validateForm=e,console.log(this.validateForm)},login:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/loginSystem?username=lijiazhao&password=lijiazhao");case 2:a=t.sent,a.data;case 4:case"end":return t.stop()}}),t)})))()},initTableData:function(){var e=arguments,t=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){var r,n,o,s,i,l,c,u,h,p,m,b,f,y,g,v;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]&&e[0],n=t.searchValidateForm.companyId,""!=n&&n||(n=null),o=t.searchValidateForm.spotId,""!=o&&o||(o=null),s=t.searchValidateForm.type,""!=s&&s||(s=null),i=t.searchValidateForm.selectDateState,""!=i&&i||(i=null),l=t.searchValidateForm.startEndDate,""!=l&&l?(c=d(t.searchValidateForm.startEndDate[0],t.searchValidateForm.selectDateState),u=d(t.searchValidateForm.startEndDate[1],t.searchValidateForm.selectDateState)):(c=null,u=null),h=t.searchValidateForm.payType,""!=h&&h||(h=null),p=t.searchValidateForm.status,""!=p&&p||(p=null),m=t.searchValidateForm.amountType,""!=m&&m||(m=null),b=t.searchValidateForm.realAmount,""!=b&&b||(b=null),f=t.searchValidateForm.robotCode,""!=f&&f||(f=null),y={},y=r?{companyId:n,spotId:o,type:s,dateType:i,startDate:c,endDate:u,payType:h,status:p,amountType:m,realAmount:b,robotCode:f,order:t.order,pageNum:(t.currentPage-1)*t.pageSize,pageSize:t.pageSize}:{companyId:n,spotId:o,type:s,dateType:i,startDate:c,endDate:u,payType:h,status:p,amountType:m,realAmount:b,order:t.order,pageNum:0,pageSize:t.pageSize},t.tableLoading=!0,a.next=26,t.$http.get("/system/robot_time_statistics/spotAmountList",{params:y});case 26:return g=a.sent,v=g.data,"200"==v.state&&(t.tableData=v.data,s=JSON.parse(v.type),t.total=s.count,t.totalRealAmount=s.realAmount,t.totalYysc=s.yysc,t.totalWuyingshou=s.wuyingshou,t.tableLoading=!1),a.abrupt("return",v);case 30:case"end":return a.stop()}}),a)})))()},initEchartsData:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var a,r,n,o,s,i,l,u,h,p,m,b,f,y,g,v,F,w,S,T,V,O,x,C,D;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.searchValidateForm.companyId,""!=r&&r||(r=null),n=e.searchValidateForm.spotId,""!=n&&n||(n=null),o=e.searchValidateForm.type,""!=o&&o||(o=null),s=e.searchValidateForm.status,""!=s&&s||(s=null),i=e.searchValidateForm.selectDateState,""!=i&&i||(i=null),l=e.searchValidateForm.startEndDate,""!=l&&l?(u=d(e.searchValidateForm.startEndDate[0],e.searchValidateForm.selectDateState),h=d(e.searchValidateForm.startEndDate[1],e.searchValidateForm.selectDateState)):(u=null,h=null),p=e.searchValidateForm.payType,""!=p&&p||(p=null),s=e.searchValidateForm.status,""!=s&&s||(s=null),m=e.searchValidateForm.amountType,""!=m&&m||(m=null),b=e.searchValidateForm.realAmount,""!=b&&b||(b=null),f=e.searchValidateForm.robotCode,""!=f&&f||(f=null),"1"==e.searchValidateForm.amountType?e.echartsOrder="realAmount desc":"2"==e.searchValidateForm.amountType&&(e.echartsOrder="avgsc desc"),e.myChart.showLoading({text:"loading",color:"#c23531",textColor:"#000",maskColor:"rgba(255, 255, 255, 0.2)",zlevel:0}),t.next=26,e.$http.get("/system/robot_time_statistics/spotAmountList",{params:(a={companyId:r,spotId:n,type:o,status:s,dateType:i,startDate:u,endDate:h,payType:p},Object(c["a"])(a,"status",s),Object(c["a"])(a,"amountType",m),Object(c["a"])(a,"realAmount",b),Object(c["a"])(a,"robotCode",f),Object(c["a"])(a,"order",e.echartsOrder),a)});case 26:return y=t.sent,g=y.data,"200"==g.state&&(e.myChart.hideLoading(),v=g.data.concat(),v&&v.length<=20?e.option.dataZoom[0].end=100:e.option.dataZoom[0].end=30,F=[],w=[],S=[],T=[],V=[],O=[],x=[],C=[],v.forEach((function(e){F.push(e.spotId),w.push(e.spotName),S.push(e.realAmount),T.push(e.avgsc),V.push(e.checkDate),O.push(e.tb),x.push(e.hb),C.push(e.jxz)})),e.myChart.getZr().on("click",(function(t){var a=[t.offsetX,t.offsetY];if(e.myChart.containPixel("grid",a)){var r=e.myChart.convertFromPixel({seriesIndex:0},[t.offsetX,t.offsetY])[0],n=F[r],o=window.parent.document.querySelector('[data-url="/page/assetsSystem/realTimeLine/index.html"]');window.sessionStorage.setItem("realTimeLineSpotId",n),o.click()}})),D="","1"==e.searchValidateForm.amountType?(D="交易金额/元",e.option.series[0].data=S):"2"==e.searchValidateForm.amountType&&(D="平均交易金额/元",e.option.series[0].data=T),e.option.xAxis[0].data=w,e.option.series[0].itemStyle.normal.label.formatter=function(e){var t="";return t=C[e.dataIndex],t},e.option.series[1].data=O,"3"==e.searchValidateForm.selectDateState?(e.option.legend.data=[D,"同比/%"],e.option.series[2].data=[]):(e.option.legend.data=[D,"同比/%","环比/%"],e.option.series[2].data=x),w&&w.length<=20?e.option.dataZoom[0].end=100:e.option.dataZoom[0].end=30,e.option.legend.data[0]=D,e.option.series[0].name=D,e.myChart.setOption(e.option)),t.abrupt("return",g);case 30:case"end":return t.stop()}}),t)})))()},getCompanyList:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=null),a.next=3,t.$http.get("/system/robot_time_statistics/companyList",{params:{spotId:e}});case 3:if(r=a.sent,n=r.data,"200"!=n.state){a.next=10;break}return t.searchCompanyOptions=n.data,a.abrupt("return",n);case 10:return a.abrupt("return");case 11:case"end":return a.stop()}}),a)})))()},getScenicList:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=null),a.next=3,t.$http.get("/system/robot_time_statistics/spotList",{params:{companyId:e}});case 3:if(r=a.sent,n=r.data,"200"!=n.state){a.next=10;break}return t.searchScenicOptions=n.data,a.abrupt("return",n);case 10:return a.abrupt("return");case 11:case"end":return a.stop()}}),a)})))()},getExportTableData:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var a,r,n,o,s,i,l,c,u,h,p,m,b,f;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.searchValidateForm.companyId,""!=a&&a||(a=null),r=e.searchValidateForm.spotId,""!=r&&r||(r=null),n=e.searchValidateForm.type,""!=n&&n||(n=null),o=e.searchValidateForm.payType,""!=o&&o||(o=null),s=e.searchValidateForm.status,""!=s&&s||(s=null),i=e.searchValidateForm.selectDateState,""!=i&&i||(i=null),l=e.searchValidateForm.startEndDate,""!=l&&l?(c=d(e.searchValidateForm.startEndDate[0],e.searchValidateForm.selectDateState),u=d(e.searchValidateForm.startEndDate[1],e.searchValidateForm.selectDateState)):(c=null,u=null),h=e.searchValidateForm.amountType,""!=h&&h||(h=null),p=e.searchValidateForm.realAmount,""!=p&&p||(p=null),m=e.searchValidateForm.robotCode,""!=m&&m||(m=null),t.next=22,e.$http.get("/system/robot_time_statistics/spotAmountList",{params:{companyId:a,spotId:r,type:n,status:s,dateType:i,startDate:c,endDate:u,payType:o,amountType:h,realAmount:p,robotCode:m,order:e.order}});case 22:if(b=t.sent,f=b.data,"200"!=f.state){t.next=28;break}e.exportTableData=f.data,t.next=29;break;case 28:return t.abrupt("return");case 29:case"end":return t.stop()}}),t)})))()},onDateChange:function(){var e=[];for(var t in this.searchTableFields){var a={};a[t]=this.searchTableFields[t],e.push(a)}if("1"==this.searchValidateForm.selectDateState){if(this.dateType="daterange",this.searchTableFields.hasOwnProperty("环比")||e.forEach((function(t,a){"tb"==Object.values(t)[0]&&e.splice(a+1,0,{"环比":"hb"})})),this.searchTableFields.hasOwnProperty("目标金额")||this.searchTableFields.hasOwnProperty("目标完成比例"))for(var r=e.length-1;r>0;r--)"target"!=Object.values(e[r])[0]&&"mbwcbl"!=Object.values(e[r])[0]||e.splice(r,1)}else"2"==this.searchValidateForm.selectDateState?(this.dateType="monthrange",this.searchTableFields.hasOwnProperty("环比")||e.forEach((function(t,a){"tb"==Object.values(t)[0]&&e.splice(a+1,0,{"环比":"hb"})})),"1"==this.searchValidateForm.amountType&&(this.searchTableFields.hasOwnProperty("目标金额")&&this.searchTableFields.hasOwnProperty("目标完成比例")||e.forEach((function(t,a){"wuyingshou"==Object.values(t)[0]&&(e.splice(a+1,0,{"目标完成比例":"mbwcbl"}),e.splice(a+1,0,{"目标金额":"target"}))})))):"3"==this.searchValidateForm.selectDateState&&(this.dateType="yearrange",this.searchTableFields.hasOwnProperty("环比")&&e.forEach((function(t,a){"hb"==Object.values(t)[0]&&e.splice(a,1)})),"1"==this.searchValidateForm.amountType&&(this.searchTableFields.hasOwnProperty("目标金额")&&this.searchTableFields.hasOwnProperty("目标完成比例")||e.forEach((function(t,a){"wuyingshou"==Object.values(t)[0]&&(e.splice(a+1,0,{"目标完成比例":"mbwcbl"}),e.splice(a+1,0,{"目标金额":"target"}))}))));var n={};e.forEach((function(e){n[Object.keys(e)[0]]=Object.values(e)[0]})),console.log(n),this.searchTableFields=n},onSortChange:function(e){var t=e.column,a=e.prop,r=e.order;console.log(t,a,r),"ascending"==r?r="asc":"descending"==r&&(r="desc"),this.order=r?"".concat(a," ").concat(r):null,this.initTableData()},drawEcharts:function(){var e=this;this.myChart=this.$echarts.init(document.getElementById("myChart")),this.option={tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},saveAsImage:{show:!0}}},legend:{data:["交易金额/元","同比/%","环比/%"],top:0},dataZoom:[{type:"inside",start:0,end:30},{type:"slider"}],xAxis:[{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisPointer:{type:"shadow"}}],yAxis:[{type:"value",axisLabel:{formatter:"{value} 元"}},{type:"value",axisLabel:{formatter:"{value} %"}}],series:[{name:"交易金额/元",type:"bar",data:[],itemStyle:{normal:{label:{show:!0,position:"top",textStyle:{color:"black",fontSize:16},formatter:""}}}},{name:"同比/%",type:"line",yAxisIndex:1,data:[]},{name:"环比/%",type:"line",yAxisIndex:1,data:[]}]},this.myChart.setOption(this.option),window.addEventListener("resize",(function(){e.myChart.resize()}))},drawPieEcharts:function(){var e=this;this.myPieChart=this.$echarts.init(document.getElementById("myPieChart")),this.pieOption={title:{text:"支付方式占比",subtext:"Pay Way Ratio",left:"center"},tooltip:{trigger:"item"},legend:{left:"center",bottom:"50px"},series:[{name:"支付方式占比",type:"pie",radius:"50%",selectedMode:"single",label:{show:!0,formatter:"{b}: {@支付方式占比} ({d}%)"},data:[{value:1048,name:"微信支付金额/元"},{value:735,name:"储值抵扣金额/元"},{value:580,name:"储值抵扣+微信支付金额"},{value:484,name:"押金抵扣"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},this.myPieChart.setOption(this.pieOption),window.addEventListener("resize",(function(){e.myPieChart.resize()}))},onChangeSearchCompany:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){var r,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.getScenicList(e);case 2:if(r=a.sent,console.log(r),n=r.data,t.searchScenicOptions=n,0!=n.length){a.next=9;break}return t.searchValidateForm.spotId="",a.abrupt("return");case 9:o=!1,n.forEach((function(e){e.SCENIC_SPOT_ID!=t.searchValidateForm.spotId||(o=!0)})),e&&!o&&(t.searchValidateForm.spotId=n[0].SCENIC_SPOT_ID);case 12:case"end":return a.stop()}}),a)})))()},onChangeSearchSpot:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){var r,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.getCompanyList(e);case 2:if(r=a.sent,n=r.data,t.searchCompanyOptions=n,0!=n.length){a.next=8;break}return t.searchValidateForm.companyId="",a.abrupt("return");case 8:o=!1,n.forEach((function(e){e.COMPANY_ID!=t.searchValidateForm.companyId||(o=!0)})),e&&!o&&(t.searchValidateForm.companyId=n[0].COMPANY_ID);case 11:case"end":return a.stop()}}),a)})))()},onChangeType:function(e){var t=[];for(var a in this.searchTableFields){var r={};r[a]=this.searchTableFields[a],t.push(r)}if("1"==e){if(this.searchTableFields.hasOwnProperty("机器人编号"))for(var n=t.length-1;n>0;n--)"ROBOT_CODE"==Object.values(t[n])[0]&&t.splice(n,1);this.disabledStatGrossProfit=!1,this.disabledStatPayWay=!1,this.disabledAmountType=!1}else"2"==e&&(this.searchTableFields.hasOwnProperty("机器人编号")||t.splice(2,0,{"机器人编号":"ROBOT_CODE"}),this.disabledStatGrossProfit=!0,this.disabledStatPayWay=!0,this.searchValidateForm.amountType="1",this.searchTableFields.hasOwnProperty("交易金额/元")||t.splice(2,0,{"交易金额/元":"realAmount"}),this.disabledAmountType=!0,"1"!=this.searchValidateForm.selectDateState&&(this.searchTableFields.hasOwnProperty("目标金额")&&this.searchTableFields.hasOwnProperty("目标完成比例")||t.forEach((function(e,a){"wuyingshou"==Object.values(e)[0]&&(t.splice(a+1,0,{"目标完成比例":"mbwcbl"}),t.splice(a+1,0,{"目标金额":"target"}))}))));var o={};t.forEach((function(e){o[Object.keys(e)[0]]=Object.values(e)[0]})),this.searchTableFields=o},onChangeAmountType:function(e){var t=[];for(var a in this.searchTableFields){var r={};r[a]=this.searchTableFields[a],t.push(r)}if("1"==e)this.searchTableFields.hasOwnProperty("交易金额/元")||t.splice(2,0,{"交易金额/元":"realAmount"}),"1"!=this.searchValidateForm.selectDateState&&(this.searchTableFields.hasOwnProperty("目标金额")&&this.searchTableFields.hasOwnProperty("目标完成比例")||t.forEach((function(e,a){"wuyingshou"==Object.values(e)[0]&&(t.splice(a+1,0,{"目标完成比例":"mbwcbl"}),t.splice(a+1,0,{"目标金额":"target"}))})));else if("2"==e&&(this.searchTableFields.hasOwnProperty("交易金额/元")&&t.forEach((function(e,a){"realAmount"==Object.values(e)[0]&&t.splice(a,1)})),this.searchTableFields.hasOwnProperty("目标金额")||this.searchTableFields.hasOwnProperty("目标完成比例")))for(var n=t.length-1;n>0;n--)"target"!=Object.values(t[n])[0]&&"mbwcbl"!=Object.values(t[n])[0]||t.splice(n,1);var o={};t.forEach((function(e){o[Object.keys(e)[0]]=Object.values(e)[0]})),this.searchTableFields=o},onChangeCompany:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r={},r=t.companyOptions.find((function(t){return t.COMPANY_NAME===e})),n=r.COMPANY_ID,t.validateForm.companyId=n;case 4:case"end":return a.stop()}}),a)})))()},onChangeSpot:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r={},r=t.scenicOptions.find((function(t){return t.SCENIC_SPOT_NAME===e})),n=r.SCENIC_SPOT_ID,t.validateForm.spotId=n;case 4:case"end":return a.stop()}}),a)})))()},onChangeSubject:function(e){var t={};t=this.subjectOptions.find((function(t){return t.COMPANY_NAME===e})),console.log(t.COMPANY_ID),this.validateForm.subjectId=t.COMPANY_ID},onReset:function(){this.searchValidateForm.companyId="",this.searchValidateForm.spotId="",this.searchValidateForm.type="1",this.searchValidateForm.status="1",this.searchValidateForm.startEndDate=[new Date,new Date],this.searchValidateForm.amountType="1",this.searchValidateForm.realAmount="",this.searchValidateForm.robotCode="",this.searchValidateForm.selectDateState="1",this.dateType="daterange",this.disabledStatGrossProfit=!1,this.disabledStatPayWay=!1,this.disabledAmountType=!1,this.searchTableFields={"起止时间":"checkDate","景区名称":"spotName","交易金额/元":"realAmount","同比":"tb","环比":"hb","平均单台交易金额/元":"avgsc","运营时长/小时":"yysc","平均单台运营时长/小时":"avgyysc","在线订单数":"jxz","无营收天数":"wuyingshou"},this.initTableData(),this.initEchartsData()},onStatGrossProfit:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;var a=d(t.searchValidateForm.startEndDate[0],t.searchValidateForm.selectDateState),r=d(t.searchValidateForm.startEndDate[1],t.searchValidateForm.selectDateState),n=d(new Date,t.searchValidateForm.selectDateState),o="";switch(t.searchValidateForm.selectDateState){case"1":o="日";break;case"2":o="月";break;case"3":o="年";break;default:break}a==n||r==n?t.$confirm("因当".concat(o,"未结束，统计当").concat(o,"的同比、环比数据不准确，是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.showTable=!1,t.showPieChart=!1,t.showBarChart=!0,t.initEchartsData()})).catch((function(){})):(t.showTable=!1,t.showPieChart=!1,t.showBarChart=!0,t.initEchartsData())}))},onStatPayWay:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;t.showTable=!1,t.showBarChart=!1,t.showPieChart=!0}))},onExportReport:function(){var e=this;this.$nextTick((function(){var t=document.getElementById("exportReport");t.href=e.myChart.getDataURL()}))},onSearch:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;var a=d(t.searchValidateForm.startEndDate[0],t.searchValidateForm.selectDateState),r=d(t.searchValidateForm.startEndDate[1],t.searchValidateForm.selectDateState),n=d(new Date,t.searchValidateForm.selectDateState),o="";switch(t.searchValidateForm.selectDateState){case"1":o="日";break;case"2":o="月";break;case"3":o="年";break;default:break}a==n||r==n?t.$confirm("因当".concat(o,"未结束，统计当").concat(o,"的同比、环比数据不准确，是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.showBarChart=!1,t.showPieChart=!1,t.showTable=!0,t.initTableData()})).catch((function(){})):(t.showBarChart=!1,t.showPieChart=!1,t.showTable=!0,t.initTableData())}))},exportExcel:function(){var e=this;this.$confirm("确认导出Excel表格?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.downloadLoading=!0,t.next=3,e.getExportTableData();case 3:e.$nextTick((function(){var t={raw:!0},a=XLSX.utils.table_to_book(document.querySelector("#outTable"),t),r=XLSX.write(a,{bookType:"xlsx",bookSST:!0,type:"array"});try{window.saveAs(new Blob([r],{type:"application/octet-stream"}),"按景区统计运营流水.xlsx")}catch(n){"undefined"!==typeof console&&console.log(n,r)}return e.downloadLoading=!1,r})),e.$message({type:"success",message:"已成功导出Excel表格！",offset:100,center:!0,duration:1e3});case 5:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({type:"info",message:"已取消导出Excel表格",offset:100,center:!0,duration:1e3})}))},onAdd:function(){this.dialogVisible=!0,this.dialogState="add"},editRow:function(e,t){console.log(e,t),this.dialogVisible=!0;var a=Object.assign({},t);this.validateForm=a,this.dialogState="edit"},dialogClose:function(){this.dialogVisible=!1,this.$refs.validateForm.resetFields(),this.getValidateForm()},handleClose:function(e){e(),this.$refs.validateForm.resetFields(),this.getValidateForm()},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;console.log(t.validateForm),"add"==t.dialogState?console.log("新增公司信息"):"edit"==t.dialogState&&console.log("编辑公司信息"),t.dialogVisible=!1,t.$refs.validateForm.resetFields()}))},getSummaries:function(e){var t=this,a=e.columns,r=e.data,n=[];return a.forEach((function(e,a){if(0!==a){var o=r.map((function(t){return Number(t[e.property])}));o.every((function(e){return isNaN(e)}))||(n[a]=o.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0),n[a]=""),"realAmount"==e.property&&(n[a]=t.totalRealAmount+"元"),"yysc"==e.property&&(n[a]=t.totalYysc+"小时")}else n[a]="合计"})),n},onCurrentChange:function(e){this.currentPage=e,this.initTableData(!0)},onSizeChange:function(e){this.pageSize=e,this.initTableData(!0)}},components:{},computed:{activeFixed:function(){return function(e){}},tableContentValue:function(){return function(e,t){var a="";return a="tb"==t||"hb"==t||"mbwcbl"==t?e[t]?e[t]+"%":"0%":e[t],a}},sortable:function(){return function(e){var t="";return t="spotName"!=e&&"机器人型号字段"!=e&&"运营模式字段"!=e&&"custom",t}}}},p=h,m=(a("0f14"),a("2877")),b=Object(m["a"])(p,i,l,!1,null,"2f9d6ce7",null),f=b.exports,y={name:"App",components:{RobotSpotStatisticsAmount:f}},g=y,v=(a("5c0b"),Object(m["a"])(g,o,s,!1,null,null,null)),F=v.exports,w=a("5880"),S=a.n(w);n.a.use(S.a);var T=new S.a.Store({state:{},mutations:{},actions:{},modules:{}}),V=(a("9e1f"),a("450d"),a("6ed5")),O=a.n(V),x=(a("0fb7"),a("f529")),C=a.n(x),D=(a("cbb5"),a("8bbc")),P=a.n(D),k=(a("be4f"),a("896a")),E=a.n(k),I=(a("826b"),a("c263")),_=a.n(I),A=(a("3db2"),a("58b8")),j=a.n(A),N=(a("eca7"),a("3787")),R=a.n(N),$=(a("425f"),a("4105")),L=a.n($),z=(a("a7cc"),a("df33")),M=a.n(z),B=(a("672e"),a("101e")),Y=a.n(B),W=(a("5466"),a("ecdf")),G=a.n(W),X=(a("38a0"),a("ad41")),Z=a.n(X),q=(a("10cb"),a("f3ad")),J=a.n(q),U=(a("bdc7"),a("aa2f")),H=a.n(U),K=(a("de31"),a("c69e")),Q=a.n(K),ee=(a("a673"),a("7b31")),te=a.n(ee),ae=(a("adec"),a("3d2d")),re=a.n(ae),ne=(a("6611"),a("e772")),oe=a.n(ne),se=(a("1f1a"),a("4e4b")),ie=a.n(se),le=(a("1951"),a("eedf")),ce=a.n(le);n.a.use(ce.a),n.a.use(ie.a),n.a.use(oe.a),n.a.use(re.a),n.a.use(te.a),n.a.use(Q.a),n.a.use(H.a),n.a.use(J.a),n.a.use(Z.a),n.a.use(G.a),n.a.use(Y.a),n.a.use(M.a),n.a.use(L.a),n.a.use(R.a),n.a.use(j.a),n.a.use(_.a),n.a.use(E.a),n.a.use(P.a),n.a.prototype.$message=C.a,n.a.prototype.$confirm=O.a.confirm;var ue=a("bc3a"),de=a.n(ue),he=a("164e");de.a.defaults.withCredentials=!0,n.a.prototype.$http=de.a,n.a.config.productionTip=!1,n.a.prototype.$echarts=he,new n.a({store:T,render:function(e){return e(F)}}).$mount("#app")},5880:function(e,t){e.exports=Vuex},"5c0b":function(e,t,a){"use strict";a("9c0c")},"8bbf":function(e,t){e.exports=Vue},"9c0c":function(e,t,a){}});
//# sourceMappingURL=index.67b7c1bd.js.map