(function(e){function t(t){for(var r,o,i=t[0],c=t[1],l=t[2],u=0,h=[];u<i.length;u++)o=i[u],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&h.push(n[o][0]),n[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);d&&d(t);while(h.length)h.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],r=!0,i=1;i<a.length;i++){var c=a[i];0!==n[c]&&(r=!1)}r&&(s.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},n={app:0},s=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var d=c;s.push([1,"chunk-vendors"]),a()})({0:function(e,t){},1:function(e,t,a){e.exports=a("56d7")},2:function(e,t){},3:function(e,t){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("order-statistiacs")],1)},s=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"partner-company"},[a("el-container",[a("el-header",{staticClass:"header"},[a("el-form",{ref:"searchValidateForm",staticClass:"search-validate-form",attrs:{inline:!0,model:e.searchValidateForm,"label-width":"100px",rules:e.searchValidateFormRules}},[a("el-form-item",{attrs:{label:"",prop:"companyId"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择公司",clearable:""},on:{change:e.onChangeSearchCompany},model:{value:e.searchValidateForm.companyId,callback:function(t){e.$set(e.searchValidateForm,"companyId",t)},expression:"searchValidateForm.companyId"}},e._l(e.searchCompanyOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.COMPANY_NAME,value:e.COMPANY_ID}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"spotId"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择景区",clearable:""},on:{change:e.onChangeSearchSpot},model:{value:e.searchValidateForm.spotId,callback:function(t){e.$set(e.searchValidateForm,"spotId",t)},expression:"searchValidateForm.spotId"}},e._l(e.searchScenicOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.SCENIC_SPOT_NAME,value:e.SCENIC_SPOT_ID}})})),1)],1),a("el-form-item",{attrs:{label:"",prop:"startEndDate"}},[a("el-date-picker",{attrs:{"unlink-panels":"",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":e.valueFormat},model:{value:e.searchValidateForm.startEndDate,callback:function(t){e.$set(e.searchValidateForm,"startEndDate",t)},expression:"searchValidateForm.startEndDate"}})],1)],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-data-line"},on:{click:function(t){return e.onStatGrossProfit("searchValidateForm")}}},[e._v("统计报表")]),a("a",{attrs:{href:"",id:"exportReport",download:"订单数量"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-s-data"},on:{click:e.onExportReport}},[e._v("导出报表")])],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.onSearch("searchValidateForm")}}},[e._v("查询数据")]),a("el-button",{attrs:{type:"primary",loading:e.downloadLoading,icon:"el-icon-s-data"},on:{click:e.exportExcel}},[e._v("导出数据")]),a("a",{staticClass:"exportA",attrs:{id:"exportA",href:e.downloadUrl,download:""}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showTable,expression:"showTable"}]},[a("el-main",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","header-cell-style":{background:"#f2f2f2",color:"#606266",height:"38px",padding:"0px"},"cell-style":{height:"38px",padding:"0"}}},e._l(e.tableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t,"min-width":"130"}})})),1),a("el-table",{staticClass:"table",staticStyle:{width:"100%",display:"none"},attrs:{id:"outTable",data:e.exportTableData,border:""}},e._l(e.tableFields,(function(e,t){return a("el-table-column",{key:t,attrs:{prop:e,label:t,"min-width":"130",align:"center"}})})),1)],1),a("el-footer")],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.showTable,expression:"!showTable"}],staticClass:"my-echarts"},[a("div",{attrs:{id:"myChart"}})])],1)],1)},i=[],c=a("b85c"),l=a("1da1"),d=(a("96cf"),a("a9e3"),a("99af"),a("159b"),a("a434"),a("d81d"),a("fb6a"),a("b680"),a("21a6")),u=a.n(d),h=a("1146"),p=a.n(h);a("d3b7"),a("25f0"),a("4d90");var f={name:"SettlementFlow",data:function(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,a,r){a||r(),Number(a)?r():r(new Error(e+"必须为数字值"))}}return{showTable:!0,feeInput:"",taxInput:"",searchFeeInput:"",searchTaxInput:"",tableFields:{"订单状态":"订单状态","订单数量":"订单数量","订单计费金额/元":"订单计费金额","退款金额/元":"退款金额","实际收入金额/元":"实际收入金额","最终入账金额/元":"最终入账金额"},tableData:[{"订单状态":"进行中","订单数量":0,"订单计费金额":0,"退款金额":0,"实际收入金额":0,"最终入账金额":0}],tableLoading:!1,searchCompanyOptions:[],searchScenicOptions:[],dateStateOptions:[{value:"1",label:"按月查询"},{value:"2",label:"按日查询"},{value:"3",label:"按年查询"}],typeOptions:[{value:"1",label:"按订单数量统计"},{value:"2",label:"按订单计费金额统计"}],exportTableData:[],downloadLoading:!1,currentPage:1,pageSize:10,dialogVisible:!1,dialogState:"",selectDateState:"1",dateType:"monthrange",valueFormat:"yyyy-MM-dd",searchValidateForm:{companyId:"",spotId:"",startEndDate:"",type:"1"},searchVF:{companyId:"",spotId:"",startEndDate:"",type:"1"},validateForm:{},searchPartnerCompanyName:"",searchScenicName:"",searchSelectDateState:"1",searchStartEndDate:"",searchPayState:"",companys:[],companyState:"",scenics:[],scenicState:"",downloadUrl:"",total:0,myChart:null,markLineData:[],option:{},searchValidateFormRules:{},validateFormRules:{moneyOut:[{validator:e("付款金额"),trigger:["blur","change"]}],moneyIn:[{validator:e("收款金额"),trigger:["blur","change"]}]}}},created:function(){this.getValidateForm(),this.getCompanyList(),this.getScenicList(),this.initTableData()},beforeMount:function(){},mounted:function(){this.drawEcharts()},methods:{getValidateForm:function(){var e={};for(var t in this.tableFields)e[this.tableFields[t]]="";this.validateForm=e},login:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/loginSystem?username=lijiazhao&password=lijiazhao");case 2:a=t.sent,a.data;case 4:case"end":return t.stop()}}),t)})))()},getCompanyList:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=null),a.next=3,t.$http.get("/system/robot_time_statistics/companyList",{params:{spotId:e}});case 3:if(r=a.sent,n=r.data,"200"!=n.state){a.next=10;break}return t.searchCompanyOptions=n.data,a.abrupt("return",n);case 10:return a.abrupt("return");case 11:case"end":return a.stop()}}),a)})))()},getScenicList:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=null),a.next=3,t.$http.get("/system/robot_time_statistics/spotList",{params:{companyId:e}});case 3:if(r=a.sent,n=r.data,"200"!=n.state){a.next=10;break}return t.searchScenicOptions=n.data,a.abrupt("return",n);case 10:return a.abrupt("return");case 11:case"end":return a.stop()}}),a)})))()},initTableData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,r,n,s,o,i,c,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.searchVF.companyId,""!=a&&a||(a=null),r=e.searchVF.spotId,""!=r&&r||(r=null),n=e.searchVF.startEndDate,""!=n&&n?(s=e.searchVF.startEndDate[0],o=e.searchVF.startEndDate[1]):(s=null,o=null),e.tableLoading=!0,t.next=9,e.$http.get("/system/order_statistics/findData",{params:{company:a,spot:r,beginTime:s,endTime:o}});case 9:i=t.sent,c=i.data,e.tableData=c.data,e.total=c.total,e.tableLoading=!1,e.myChart.hideLoading(),l=c.data.concat(),l.forEach((function(t,a){("2"==e.searchVF.type&&"实际收入金额"==t.订单状态||"已付款"==t.订单状态)&&l.unshift(l.splice(a,1)[0])})),d=l.map((function(e){return[e.订单状态,e.订单数量]})),d.unshift(["order","已付款订单","其他订单"]),e.addOtherData(d,5),e.option.dataset.source=d,e.option.series[0].markLine.data=e.markLineData,e.myChart.setOption(e.option);case 23:case"end":return t.stop()}}),t)})))()},getExportTableData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/system/order_statistics/findData");case 2:if(a=t.sent,r=a.data,"200"!=r.state){t.next=8;break}e.exportTableData=r.data,t.next=9;break;case 8:return t.abrupt("return");case 9:case"end":return t.stop()}}),t)})))()},editTableData:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.post("/system/account_close/update",e);case 2:r=a.sent,n=r.data,"200"==n.state?(t.$message({message:n.msg,type:"success",offset:100,center:!0,duration:1e3}),t.initTableData()):t.$message({message:n.msg,type:"error",offset:100,center:!0,duration:3e3});case 5:case"end":return a.stop()}}),a)})))()},getMarkLineData:function(e){var t=this.myChart.getHeight(),a=this.myChart.getWidth(),r=.25*a,n=r+t/4*Math.cos(20*3.14/180),s=.5*t-t/4*Math.sin(20*3.14/180),o=e/100*360,i=0;i=o<=20?20-o:360-(o-20),i<270&&i>20&&(i=270);var c=0,l=0;return c=r+t/4*Math.cos(3.14*i/180),l=.5*t-t/4*Math.sin(3.14*i/180),[[{x:n,y:s},{x:"75%",y:"35%"}],[{x:c,y:l},{x:"75%",y:"65%"}]]},addOtherData:function(e,t){var a=0,r=0;e.forEach((function(e,t){if(t>0){var a,n=0,s=Object(c["a"])(e);try{for(s.s();!(a=s.n()).done;){var o=a.value,i=isNaN(o)?0:Number(o);1===n&&(r+=i),n++}}catch(l){s.e(l)}finally{s.f()}}}));for(var n=e.slice(e.length-t),s=["其他"],o=0;o<n.length;o++){var i,l=0,d=Object(c["a"])(n[o]);try{for(d.s();!(i=d.n()).done;){var u=i.value,h=isNaN(u)?0:u;l&&(s[l]?s[l]+=h:s.push(h)),l++}}catch(p){d.e(p)}finally{d.f()}n[o].splice(1,0,"")}e.push(s),a=r?(s[1]/r*100).toFixed(2):100,this.markLineData=this.getMarkLineData(a)},drawEcharts:function(){this.myChart=this.$echarts.init(document.getElementById("myChart"));var e=[["order","已付款订单","其他订单"],["已付款",944],["进行中",50],["交易关闭",16],["免单",20],["全额退款",9],["未付款",11]];this.addOtherData(e,5),this.option={title:{text:"订单数量",subtext:"Order Number",left:"center"},legend:{left:"center",bottom:"0"},tooltip:{},dataset:{source:e},series:[{name:"已付款订单数量统计",type:"pie",radius:"50%",center:["25%","50%"],selectedMode:"single",label:{show:!0,position:"inside",formatter:"{b}: {@已付款订单} ({d}%)"},startAngle:20,clockwise:!1,markLine:{lineStyle:{type:"solid",color:"#BFBFBF"},symbol:"none",data:this.markLineData}},{name:"其他订单数量统计",type:"pie",radius:"30%",center:["75%","50%"],selectedMode:"single",encode:{itemName:"order",value:"其他订单"},label:{show:!0,formatter:"{b}: {@其他订单} ({d}%)"}}]},this.myChart.setOption(this.option);window.addEventListener("resize",(function(){}))},getTableData:function(){this.searchValidateForm.companyId!=this.searchVF.companyId||this.searchValidateForm.spotId!=this.searchVF.spotId||this.selectDateState!=this.searchSelectDateState||this.searchValidateForm.startEndDate!=this.searchVF.startEndDate||this.searchValidateForm.type!=this.searchVF.type?(this.searchVF.companyId=this.searchValidateForm.companyId,this.searchVF.spotId=this.searchValidateForm.spotId,this.searchSelectDateState=this.selectDateState,this.searchVF.startEndDate=this.searchValidateForm.startEndDate,this.searchVF.type=this.searchValidateForm.type,console.log("调用接口"),this.initTableData()):this.myChart.hideLoading()},onChangeSearchCompany:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var r,n,s,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.getScenicList(e);case 2:if(r=a.sent,n=r.data,t.searchScenicOptions=n,0!=n.length){a.next=8;break}return t.searchValidateForm.spotId="",a.abrupt("return");case 8:s=!1,n.forEach((function(e){e.SCENIC_SPOT_ID!=t.searchValidateForm.spotId||(s=!0)})),o=n[0].SCENIC_SPOT_ID,e&&!s&&(t.searchValidateForm.spotId=o);case 12:case"end":return a.stop()}}),a)})))()},onChangeSearchSpot:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(t.searchValidateForm.paymentType=[]),a.next=3,t.getCompanyList(e);case 3:if(r=a.sent,n=r.data,t.searchCompanyOptions=n,0!=n.length){a.next=9;break}return t.searchValidateForm.companyId="",a.abrupt("return");case 9:s=!1,n.forEach((function(e){e.COMPANY_ID!=t.searchValidateForm.companyId||(s=!0)})),e&&!s&&(t.searchValidateForm.companyId=n[0].COMPANY_ID);case 12:case"end":return a.stop()}}),a)})))()},onChangeSearchType:function(e){console.log(e),1==e?this.tableFields={"订单状态":"订单状态","订单数量":"订单数量","订单计费金额/元":"订单计费金额","退款金额/元":"退款金额","实际收入金额/元":"实际收入金额","最终入账金额/元":"最终入账金额"}:2==e&&(this.tableFields={"订单状态":"订单状态","订单数量":"订单数量","订单计费金额/元":"订单计费金额"})},onDateChange:function(){console.log(this.selectDateState),"1"==this.selectDateState?(this.dateType="monthrange",this.valueFormat="yyyy-MM"):"2"==this.selectDateState?(this.dateType="daterange",this.valueFormat="yyyy-MM-dd"):"3"==this.selectDateState&&(this.dateType="yearrange",this.valueFormat="yyyy")},onReset:function(){this.searchValidateForm.companyId="",this.searchValidateForm.spotId="",this.searchValidateForm.startEndDate="",this.selectDateState="1",this.dateType="monthrange",this.getTableData(),this.getCompanyList(),this.getScenicList()},onStatGrossProfit:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;t.showTable=!1,t.myChart.showLoading({text:"loading",color:"#c23531",textColor:"#000",maskColor:"rgba(255, 255, 255, 0.2)",zlevel:0}),t.getTableData()}))},onExportReport:function(){var e=this;this.$nextTick((function(){var t=document.getElementById("exportReport");t.href=e.myChart.getDataURL()}))},onSearch:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;t.showTable=!0,t.getTableData()}))},exportExcel:function(){var e=this;this.$confirm("确认导出Excel表格?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.downloadLoading=!0,t.next=3,e.getExportTableData();case 3:e.$nextTick((function(){var t={raw:!0},a=p.a.utils.table_to_book(document.querySelector("#outTable"),t),r=p.a.write(a,{bookType:"xlsx",bookSST:!0,type:"array"});try{u.a.saveAs(new Blob([r],{type:"application/octet-stream"}),"订单统计状态.xlsx")}catch(n){"undefined"!==typeof console&&console.log(n,r)}return e.downloadLoading=!1,r})),e.$message({type:"success",message:"已成功导出Excel表格！",offset:100,center:!0,duration:1e3});case 5:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({type:"info",message:"已取消导出Excel表格",offset:100,center:!0,duration:1e3})}))},onAdd:function(){this.dialogVisible=!0,this.dialogState="add"},editRow:function(e,t){this.dialogVisible=!0;var a=Object.assign({},t);this.validateForm=a},dialogClose:function(){this.dialogVisible=!1,this.$refs.validateForm.resetFields(),this.getValidateForm()},handleClose:function(e){e(),this.$refs.validateForm.resetFields(),this.getValidateForm()},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;var a=Object.assign({},t.validateForm);console.log("编辑公司信息"),t.editTableData(a),t.dialogVisible=!1,t.$refs.validateForm.resetFields()}))},onCurrentChange:function(e){this.currentPage=e,this.initTableData()},onSizeChange:function(e){this.pageSize=e,this.initTableData()}},components:{},computed:{}},m=f,b=(a("6a41"),a("2877")),y=Object(b["a"])(m,o,i,!1,null,"72d9fed6",null),g=y.exports,v={name:"App",components:{OrderStatistiacs:g}},w=v,F=(a("5c0b"),Object(b["a"])(w,n,s,!1,null,null,null)),x=F.exports,S=a("2f62");r["default"].use(S["a"]);var D=new S["a"].Store({state:{},mutations:{},actions:{},modules:{}}),V=(a("9e1f"),a("450d"),a("6ed5")),C=a.n(V),O=(a("0fb7"),a("f529")),I=a.n(O),T=(a("be4f"),a("896a")),k=a.n(T),E=(a("826b"),a("c263")),_=a.n(E),L=(a("3db2"),a("58b8")),$=a.n(L),R=(a("eca7"),a("3787")),j=a.n(R),M=(a("425f"),a("4105")),N=a.n(M),P=(a("a7cc"),a("df33")),A=a.n(P),B=(a("672e"),a("101e")),z=a.n(B),Y=(a("5466"),a("ecdf")),U=a.n(Y),G=(a("38a0"),a("ad41")),J=a.n(G),q=(a("10cb"),a("f3ad")),H=a.n(q),W=(a("bdc7"),a("aa2f")),K=a.n(W),Q=(a("de31"),a("c69e")),X=a.n(Q),Z=(a("a673"),a("7b31")),ee=a.n(Z),te=(a("adec"),a("3d2d")),ae=a.n(te),re=(a("6611"),a("e772")),ne=a.n(re),se=(a("1f1a"),a("4e4b")),oe=a.n(se),ie=(a("1951"),a("eedf")),ce=a.n(ie);r["default"].use(ce.a),r["default"].use(oe.a),r["default"].use(ne.a),r["default"].use(ae.a),r["default"].use(ee.a),r["default"].use(X.a),r["default"].use(K.a),r["default"].use(H.a),r["default"].use(J.a),r["default"].use(U.a),r["default"].use(z.a),r["default"].use(A.a),r["default"].use(N.a),r["default"].use(j.a),r["default"].use($.a),r["default"].use(_.a),r["default"].use(k.a),r["default"].prototype.$message=I.a,r["default"].prototype.$confirm=C.a.confirm;var le=a("bc3a"),de=a.n(le),ue=a("313e");de.a.defaults.withCredentials=!0,r["default"].prototype.$http=de.a,r["default"].config.productionTip=!1,r["default"].prototype.$echarts=ue,new r["default"]({store:D,render:function(e){return e(x)}}).$mount("#app")},"5c0b":function(e,t,a){"use strict";a("9c0c")},"6a41":function(e,t,a){"use strict";a("cffa")},"9c0c":function(e,t,a){},cffa:function(e,t,a){}});
//# sourceMappingURL=app.266c2c23.js.map