(function(e){function t(t){for(var i,l,o=t[0],n=t[1],d=t[2],p=0,u=[];p<o.length;p++)l=o[p],Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&u.push(r[l][0]),r[l]=0;for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);c&&c(t);while(u.length)u.shift()();return s.push.apply(s,d||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],i=!0,o=1;o<a.length;o++){var n=a[o];0!==r[n]&&(i=!1)}i&&(s.splice(t--,1),e=l(l.s=a[0]))}return e}var i={},r={app:0},s=[];function l(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=e,l.c=i,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)l.d(a,i,function(t){return e[t]}.bind(null,i));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],n=o.push.bind(o);o.push=t,o=o.slice();for(var d=0;d<o.length;d++)t(o[d]);var c=n;s.push([1,"chunk-vendors"]),a()})({0:function(e,t){},1:function(e,t,a){e.exports=a("56d7")},"180b":function(e,t,a){"use strict";a("da97")},2:function(e,t){},3:function(e,t){},"56d7":function(e,t,a){"use strict";a.r(t);a("0fae");var i=a("9e2f"),r=a.n(i),s=a("2b0e"),l=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("prize-pool")],1)},o=[],n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"partner-company"},[t("el-container",[t("el-header",{staticClass:"header"},[t("el-form",{ref:"searchValidateForm",staticClass:"search-validate-form",attrs:{inline:!0,model:e.searchValidateForm,"label-width":"100px",rules:e.searchValidateFormRules}},[t("el-form-item",{attrs:{label:"",prop:"scenicSpotName"}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择景区",clearable:""},model:{value:e.searchValidateForm.scenicSpotId,callback:function(t){e.$set(e.searchValidateForm,"scenicSpotId",t)},expression:"searchValidateForm.scenicSpotId"}},e._l(e.spotList,(function(e,a){return t("el-option",{key:e.value,attrs:{label:e.scenicSpotName,value:e.scenicSpotId}})})),1)],1),t("el-form-item",{attrs:{label:"",prop:"jackpotType"}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择奖池类型",clearable:""},model:{value:e.searchValidateForm.jackpotType,callback:function(t){e.$set(e.searchValidateForm,"jackpotType",t)},expression:"searchValidateForm.jackpotType"}},e._l(e.jackpotTypeList,(function(e,a){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.onSearch("searchValidateForm")}}},[e._v("搜索")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh-right"},on:{click:e.onReset}},[e._v("重置")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.onAdd}},[e._v("新增")])],1),t("el-main",[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","header-cell-style":{background:"#f2f2f2",color:"#606266",height:"38px",padding:"0px"},"cell-style":{height:"38px",padding:"0"}}},[e._l(e.tableFields,(function(a,i){return t("el-table-column",{key:i,attrs:{prop:a,label:i,"min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",[e._v(" "+e._s(e.tableContentValue(i.row,a))+" ")])]}}],null,!0)})})),t("el-table-column",{attrs:{label:"操作","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handlePrize(a.$index,a.row)}}},[e._v("查看奖品")]),t("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.editRow(a.$index,a.row)}}},[e._v(" 编辑 ")]),t("el-button",{attrs:{size:"small",type:"danger"},nativeOn:{click:function(t){return t.preventDefault(),e.deleteRow(a.$index,a.row)}}},[e._v("删除")])]}}])})],2),t("el-table",{staticClass:"table",staticStyle:{width:"100%",display:"none"},attrs:{id:"outTable",data:e.exportTableData,border:""}},e._l(e.tableFields,(function(e,a){return t("el-table-column",{key:a,attrs:{prop:e,label:a,"min-width":"130",align:"center"}})})),1)],1),t("el-footer",[t("div",{staticClass:"block"},[t("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total, sizes, jumper",total:e.total,"current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize},on:{"current-change":e.onCurrentChange,"size-change":e.onSizeChange}})],1)]),t("el-dialog",{staticClass:"dialog",attrs:{title:e.drawerTitle+"奖池类型",visible:e.drawer,"before-close":e.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.drawer=t}}},[t("el-form",{ref:"ruleFormRef",staticClass:"demo-ruleForm",attrs:{model:e.validateForm,"label-width":"100px",size:e.formSize,"status-icon":""}},[t("el-form-item",{attrs:{label:"景区名称",prop:"scenicSpotName"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择景区",filterable:"",clearable:""},model:{value:e.validateForm.scenicSpotId,callback:function(t){e.$set(e.validateForm,"scenicSpotId",t)},expression:"validateForm.scenicSpotId"}},e._l(e.spotList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.scenicSpotName,value:e.scenicSpotId}})})),1)],1),t("el-form-item",{attrs:{label:"奖池名称",prop:"integralNum"}},[t("el-input",{model:{value:e.validateForm.jackpotName,callback:function(t){e.$set(e.validateForm,"jackpotName",t)},expression:"validateForm.jackpotName"}})],1),t("el-form-item",{attrs:{label:"奖池排序",prop:"integralNum"}},[t("el-input",{model:{value:e.validateForm.jackpotSort,callback:function(t){e.$set(e.validateForm,"jackpotSort",e._n(t))},expression:"validateForm.jackpotSort"}})],1),t("el-form-item",{attrs:{label:"金币积分兑换",prop:"integralNum"}},[t("el-input",{model:{value:e.validateForm.integralNum,callback:function(t){e.$set(e.validateForm,"integralNum",t)},expression:"validateForm.integralNum"}})],1),t("el-form-item",{attrs:{label:"奖池类型",prop:"jackpotType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择奖池类型"},model:{value:e.validateForm.jackpotType,callback:function(t){e.$set(e.validateForm,"jackpotType",t)},expression:"validateForm.jackpotType"}},e._l(e.jackpotTypeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("div",{staticClass:"submit"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("validateForm")}}},[e._v("提交")]),t("el-button",{on:{click:e.cancelClick}},[e._v("取消")])],1)],1),t("el-dialog",{staticClass:"dialog",attrs:{width:"80%",title:"奖品详情",visible:e.dialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"header",attrs:{flex:"","justify-center":"","mb-3":""}},[t("el-form",{ref:"searchValidateFormPrize",staticClass:"search-validate-form",attrs:{inline:!0,model:e.searchValidateFormPrize,"label-width":"100px",rules:e.searchValidateFormRulesPrize}},[t("el-form-item",{attrs:{label:"",prop:"treasureName"}},[t("el-input",{attrs:{placeholder:"请输入奖品名称"},model:{value:e.searchValidateFormPrize.treasureName,callback:function(t){e.$set(e.searchValidateFormPrize,"treasureName",t)},expression:"searchValidateFormPrize.treasureName"}})],1),t("el-form-item",{attrs:{label:"",prop:"treasureType"}},[t("el-select",{attrs:{placeholder:"请选择奖品类型",filterable:"",clearable:""},model:{value:e.searchValidateFormPrize.treasureType,callback:function(t){e.$set(e.searchValidateFormPrize,"treasureType",t)},expression:"searchValidateFormPrize.treasureType"}},e._l(e.treasureTypeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"",prop:"prizeSize"}},[t("el-select",{attrs:{placeholder:"请选择奖品类型",filterable:"",clearable:""},model:{value:e.searchValidateFormPrize.prizeSize,callback:function(t){e.$set(e.searchValidateFormPrize,"prizeSize",t)},expression:"searchValidateFormPrize.prizeSize"}},e._l(e.prizeSizeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.onSearchPrize("searchValidateFormPrize")}}},[e._v("搜索")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh-right"},on:{click:e.onResetPrize}},[e._v("重置")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.onAddPrize}},[e._v("新增")])],1),t("el-table",{staticStyle:{width:"100%",height:"600px","overflow-y":"scroll"},attrs:{data:e.prizeData,border:""}},[t("el-table-column",{attrs:{label:"奖品名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.treasureName)+" ")]}}])}),t("el-table-column",{attrs:{label:"奖品类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.setTreasuretype(t.row.treasureType))+" ")]}}])}),t("el-table-column",{attrs:{label:"商店名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.shopName)+" ")]}}])}),t("el-table-column",{attrs:{label:"商品类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.shopId?t.row.treasureName:t.row.commodityType)+" ")]}}])}),t("el-table-column",{attrs:{label:"奖品图片"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-image",{staticStyle:{width:"60px",height:"60px"},attrs:{src:e.imgBaseUrl+a.row.picUrl,fit:"cover",lazy:"","preview-teleported":""},nativeOn:{click:function(t){return e.onTypeImg(a.$index)}},scopedSlots:e._u([{key:"error",fn:function(){return[t("div",{attrs:{flex:"","justify-center":"","items-center":"","h-full":"","bg-gray-200":""}},[t("el-icon",[t("icon-picture")],1)],1)]},proxy:!0}],null,!0)})]}}])}),t("el-table-column",{attrs:{label:"兑换方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.setWayType(t.row.wayType))+" ")]}}])}),t("el-table-column",{attrs:{label:"代金券额度"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.couponAmount)+" ")]}}])}),t("el-table-column",{attrs:{label:"库存数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.inventory)+" ")]}}])}),t("el-table-column",{attrs:{label:"开始兑换时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.startValidity)+" ")]}}])}),t("el-table-column",{attrs:{label:"结束兑换时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.endValidity)+" ")]}}])}),t("el-table-column",{attrs:{label:"奖品规格"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.setPrizeSize(t.row.prizeSize))+" ")]}}])}),t("el-table-column",{attrs:{label:"权重"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.setProbability(t.row.probability1))+" ")]}}])}),t("el-table-column",{attrs:{label:"有效期"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.userExpiration)+" ")]}}])}),t("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.createDate)+" ")]}}])}),t("el-table-column",{attrs:{label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.updateDate)+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"220"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handleEditPrize(a.$index,a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return e.handleDeletePrize(a.$index,a.row)}}},[e._v("删除")])]}}])})],1),t("div",{attrs:{flex:"","justify-center":""}},[t("el-pagination",{attrs:{layout:"sizes, prev, pager, next",total:e.PrizeTotalPage,"page-sizes":[10,20,30,40,50]},on:{"size-change":e.onSizeChange,"current-change":e.onCurrentChange},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1),t("el-dialog",{attrs:{width:"25%",title:e.drawerTitlePrize+"奖品类型",visible:e.drawerPrize,"close-on-click-modal":!1,"append-to-body":""},on:{"update:visible":function(t){e.drawerPrize=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticStyle:{flex:"auto"}},[t("el-button",{on:{click:e.cancelClickPrize}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitFormPrize("validateFormPrize")}}},[e._v("确认")])],1)]},proxy:!0}])},[t("el-form",{ref:"ruleFormRef",staticClass:"demo-ruleForm",attrs:{rules:e.rulesPrize,model:e.validateFormPrize,"label-width":"120px",size:e.formSize,"status-icon":""}},[t("el-form-item",{attrs:{label:"奖品名称",prop:"treasureName"}},[t("el-input",{attrs:{placeholder:"请输入奖品名称"},model:{value:e.validateFormPrize.treasureName,callback:function(t){e.$set(e.validateFormPrize,"treasureName",t)},expression:"validateFormPrize.treasureName"}})],1),t("el-form-item",{attrs:{label:"奖品类型",prop:"treasureType"}},[t("el-select",{attrs:{placeholder:"请选择奖品类型",filterable:"",clearable:"","mr-3":""},on:{change:e.changeTreasureType},model:{value:e.validateFormPrize.treasureType,callback:function(t){e.$set(e.validateFormPrize,"treasureType",t)},expression:"validateFormPrize.treasureType"}},e._l(e.treasureTypeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e.setShopCcommodity?t("el-form-item",{attrs:{label:"商店",prop:"shopId"}},[t("el-select",{attrs:{placeholder:"请选择商店",filterable:"",clearable:"","mr-3":""},model:{value:e.validateFormPrize.shopId,callback:function(t){e.$set(e.validateFormPrize,"shopId",t)},expression:"validateFormPrize.shopId"}},e._l(e.shopList,(function(e){return t("el-option",{key:e.shopId,attrs:{label:e.shopName,value:e.shopId}})})),1)],1):e._e(),e.setShopCcommodity?t("el-form-item",{attrs:{label:"商品",prop:"commodityType"}},[t("el-select",{attrs:{placeholder:"请选择商品",filterable:"",clearable:"","mr-3":""},model:{value:e.validateFormPrize.commodityType,callback:function(t){e.$set(e.validateFormPrize,"commodityType",t)},expression:"validateFormPrize.commodityType"}},e._l(e.commodityTypeOption,(function(e){return t("el-option",{key:e.commodityType,attrs:{label:e.commodityName,value:e.commodityType}})})),1)],1):e._e(),t("el-form-item",{attrs:{label:"奖品图片",prop:"picurl"}},[t("el-upload",{staticClass:"upload-demo",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","before-upload":e.beforeUpload,"file-list":e.fileList,"list-type":"picture"}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],1),t("el-form-item",{attrs:{label:"代金券额度",prop:"couponAmount"}},[t("el-input",{attrs:{placeholder:"请输入代金券额度"},model:{value:e.validateFormPrize.couponAmount,callback:function(t){e.$set(e.validateFormPrize,"couponAmount",t)},expression:"validateFormPrize.couponAmount"}})],1),t("el-form-item",{attrs:{label:"库存数量",prop:"inventory"}},[t("el-input",{attrs:{placeholder:"请输入库存数量"},model:{value:e.validateFormPrize.inventory,callback:function(t){e.$set(e.validateFormPrize,"inventory",t)},expression:"validateFormPrize.inventory"}})],1),t("el-form-item",{attrs:{label:"兑换方式",prop:"wayType"}},[t("el-select",{attrs:{placeholder:"请选择兑换方式",filterable:"",clearable:"","mr-3":""},model:{value:e.validateFormPrize.wayType,callback:function(t){e.$set(e.validateFormPrize,"wayType",t)},expression:"validateFormPrize.wayType"}},e._l(e.wayTypeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"开始兑换时间",prop:"startValidity"}},[t("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择开始兑换时间"},model:{value:e.validateFormPrize.startValidity,callback:function(t){e.$set(e.validateFormPrize,"startValidity",t)},expression:"validateFormPrize.startValidity"}})],1),t("el-form-item",{attrs:{label:"结束兑换时间",prop:"endValidity"}},[t("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择结束兑换时间"},model:{value:e.validateFormPrize.endValidity,callback:function(t){e.$set(e.validateFormPrize,"endValidity",t)},expression:"validateFormPrize.endValidity"}})],1),t("el-form-item",{attrs:{label:"奖品规格",prop:"prizeSize"}},[t("el-select",{attrs:{placeholder:"请选择奖品类型",filterable:"",clearable:"","mr-3":""},model:{value:e.validateFormPrize.prizeSize,callback:function(t){e.$set(e.validateFormPrize,"prizeSize",t)},expression:"validateFormPrize.prizeSize"}},e._l(e.prizeSizeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"权重",prop:"probability1"}},[t("el-input",{attrs:{placeholder:"请输入权重值"},model:{value:e.validateFormPrize.probability1,callback:function(t){e.$set(e.validateFormPrize,"probability1",t)},expression:"validateFormPrize.probability1"}})],1),t("el-form-item",{attrs:{label:"有效期",prop:"userExpiration"}},[t("el-input",{attrs:{placeholder:"请输入有效期"},model:{value:e.validateFormPrize.userExpiration,callback:function(t){e.$set(e.validateFormPrize,"userExpiration",t)},expression:"validateFormPrize.userExpiration"}})],1)],1)],1)],1)],1)],1)},d=[];a("d9e2"),a("14d9"),a("2c66"),a("249d"),a("40e9"),a("907a"),a("986a"),a("1d02"),a("3c5d"),a("6ce5"),a("2834"),a("4ea1"),a("b7ef"),a("88a7"),a("271a"),a("5494"),a("21a6"),a("1146");function c(e){var t=new Date(e),a=t.getFullYear().toString(),i=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getDate().toString().padStart(2,"0"),s=t.getHours().toString().padStart(2,"0"),l=t.getMinutes().toString().padStart(2,"0"),o=t.getSeconds().toString().padStart(2,"0"),n=`${a}-${i}-${r} ${s}:${l}:${o}`;return n}var p={name:"SettlementFlow",data(){function e(e=""){return(t,a,i)=>{if(!a||0==a)return i(new Error(e+"不能为空且不能为0"));isNaN(Number(a))?i(new Error(e+"必须为数字值")):i()}}function t(e=""){return(t,a,i)=>{if(!a)return i(new Error(e+"不能为空"));i()}}return{searchCompanyOptions:[],searchScenicOptions:[],receivingOptions:[],searchInStockTypeOptions:[{value:"1",label:"采购"},{value:"2",label:"回收"}],dateStateOptions:[{value:"1",label:"按月查询"},{value:"2",label:"按日查询"},{value:"3",label:"按年查询"}],searchSpotNameOptions:[],searchGoodsNameOptions:[],spotIdOptions:[],pickerOptions:{disabledDate(e){return e.getTime()>Date.now()},shortcuts:[{text:"今天",onClick(e){e.$emit("pick",new Date)}},{text:"昨天",onClick(e){const t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick(e){const t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]},exportTableData:[],downloadLoading:!1,importLoading:!1,currentPage:1,pageSize:10,selectDateState:"1",dateType:"daterange",valueFormat:"yyyy-MM-dd",searchValidateForm:{},editValidateForm:{},previewValidateForm:{previewOrderNumber:""},searchPartnerCompanyName:"",searchScenicName:"",searchSelectDateState:"1",searchStartEndDate:"",searchPayState:"",companys:[],companyState:"",scenics:[],scenicState:"",oddNumberList:[],downloadUrl:"",total:0,operateStatus:0,dialogVisible:!1,dialogState:"",currentRowOrderNumber:"",searchValidateFormRules:{},previewValidateFormRules:{previewOrderNumber:[{validator:t("单号"),required:!0,trigger:["blur","change"]}]},validateFormRules:{},rulesPrize:{userExpiration:[{validator:e(""),required:!0,trigger:["blur","change"]}]},editValidateFormRules:{},showTable:!0,tableFields:{"景区名称":"scenicSpotName","奖池名称":"jackpotName","奖池排序":"jackpotSort","金币积分兑换条件":"integralNum","奖池类型":"jackpotType","创建时间":"createDate","更新时间":"updateDate"},tableData:[],tableLoading:!1,spotList:[],treasureTypeList:[{value:"1",label:"代金卷"},{value:"2",label:"免单"},{value:"3",label:"实物"},{value:"5",label:"商品"},{value:"4",label:"谢谢参与"}],prizeSizeList:[{value:"0",label:"普通奖品"},{value:"1",label:"大奖"}],wayTypeList:[{value:"1",label:"邮寄兑换"},{value:"2",label:"现场兑换"}],jackpotTypeList:[{value:"1",label:"定点寻宝"},{value:"2",label:"定时寻宝"}],jackpotId:"",dialogVisible:!1,PrizecurrentPage:1,PrizePageSize:10,drawer:!1,direction:"rtl",drawerTitle:"",formSize:"",validateForm:{},drawerPrize:!1,drawerTitlePrize:"",validateFormPrize:{},searchValidateFormPrize:{},searchValidateFormRulesPrize:{},prizeData:[],PrizeTotalPage:0,fileList:[],file:{},imgBaseUrl:"https://jxzy-robot.oss-cn-beijing.aliyuncs.com/",shopList:[],commodityTypeOption:[],setShopCcommodity:!1}},created(){this.getSearchValidateForm(),this.getSearchValidateFormPrize(),this.getValidateForm(),this.getSpotList(),this.getShopList(),this.commodityTypeList(),this.initTableData()},beforeMount(){},mounted(){},methods:{changeTreasureType(e){this.setShopCcommodity=5==e},async commodityTypeList(){const{data:e}=await this.$http.post("/Merchant/shopCommodity/getShopCommodityList");console.log(e.data.list),200==e.state&&(this.commodityTypeOption=e.data.list)},async getShopList(){const{data:e}=await this.$http.post("/Merchant/sysShop/getShopList");console.log(e.data.list),200==e.state&&(this.shopList=e.data.list)},beforeUpload(e,t){this.file=e,this.$message({message:"上传成功",type:"success"})},deleteRow(e,t){this.$confirm("此操作将删除该行数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const{data:e}=await this.$http.post("/system/broadcastHunt/delectJackpotNew",{jackpotId:t.jackpotId});"200"==e.state?(this.$message({type:"success",message:e.msg,offset:100,center:!0,duration:1e3}),this.initTableData()):this.$message({type:"error",message:e.msg,offset:100,center:!0,duration:3e3})}).catch(()=>{this.$message({type:"info",message:"已取消删除",offset:100,center:!0,duration:1e3})})},cancelClick(){this.drawer=!1,this.validateForm={}},cancelClickPrize(){this.drawerPrize=!1,this.validateFormPrize={}},async getSpotList(){const{data:e}=await this.$http.get("/system/broadcastHunt/getSpotId");200==e.state&&(this.spotList=e.data),console.log(e)},getSearchValidateForm(){var e={};for(var t in this.tableFields)e[this.tableFields[t]]="";this.searchValidateForm={...e,goodId:null,spotId:null,inStockReason:""}},getSearchValidateFormPrize(){var e={};for(var t in this.tableFields)e[this.tableFields[t]]="";this.searchValidateFormPrize={}},getValidateForm(){var e={};for(var t in this.tableFields)e[this.tableFields[t]]="";this.validateForm=e},async login(){const{data:e}=await this.$http.post("/loginSystem?username=houjingchen&password=houjingchen")},async initTableData(e=!1){this.tableLoading=!0;const{data:t}=await this.$http.post("/system/broadcastHunt/getJackpotNew",{...this.searchValidateForm,pageNum:this.currentPage,pageSize:this.pageSize});console.log(t.data),"200"==t.state&&(this.tableData=t.data.list,this.total=t.data.total,this.tableLoading=!1)},handlePrize(e,t){this.jackpotId=t.jackpotId,this.dialogVisible=!this.dialogVisible,this.getPrizeList(this.jackpotId)},async getPrizeList(e){const{data:t}=await this.$http.post("/system/broadcastHunt/getTreasureNewHunt",{...this.searchValidateFormPrize,jackpotId:e,pageNum:this.PrizecurrentPage,pageSize:this.PrizePageSize});console.log(t),this.PrizeTotalPage=t.data.total,this.prizeData=t.data.list},async updateStatus(e,t){const{data:a}=await this.$http.post("/system/inventory_detail/updateStatus",this.$qs.stringify({id:e,status:t}));this.initTableData(!0)},async getByOrderNumber(){this.previewValidateForm.previewOrderNumber||(this.previewValidateForm.previewOrderNumber=null);const{data:e}=await this.$http.get("/system/inventory_detail/getByOrderNumber",{params:{orderNumber:this.previewValidateForm.previewOrderNumber,type:1}});return e},async getExportTableData(){var e=this.searchStartEndDate&&this.searchStartEndDate[0]||null,t=this.searchStartEndDate&&this.searchStartEndDate[1]||null;const{data:a}=await this.$http.get("/system/inventory_detail/downloadExcel",{params:{...this.searchValidateForm,startDate:e,endDate:t,type:1},responseType:"arraybuffer"});if(a){const e=window.URL.createObjectURL(new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),t=document.createElement("a");console.log(e),t.href=e,t.download="入库信息",t.click(),this.$message({message:"导出成功",type:"success"})}else this.$message({message:"导入失败",type:"error"})},async importE(e){this.importLoading=!0;var t=new FormData;t.append("file",e);const{data:a}=await this.$http.post("/system/inventory_detail/importExcel",t);this.importLoading=!1,"200"==a.state?(this.$message({message:"导入成功！",type:"success"}),this.initTableData()):this.$message({message:a.msg,type:"error"})},confirmRow(e,t){this.$confirm("确认已入库?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.updateStatus(t.id,1),this.$message({type:"success",message:"确认成功!"})}).catch(()=>{this.$message({type:"info",message:"已取消确认操作"})})},revokeRow(e,t){this.$confirm("您确定要撤销吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.updateStatus(t.id,2),this.$message({type:"success",message:"撤销成功!"})}).catch(()=>{this.$message({type:"info",message:"已取消撤销操作"})})},async onChangeApplicant(e){var t="";this.applicanteOptions.forEach(a=>{a.userId==e&&(t=a.userName)}),this.validateForm.applicantName=t},async onChangeFactory(e){var t="";this.factoryOptions.forEach(a=>{a.spotId==e&&(t=a.spotName)}),this.validateForm.factoryName=t},async onChangeConsignor(e){var t="";this.consignorOptions.forEach(a=>{a.userId==e&&(t=a.userName)}),this.validateForm.consignorName=t},async onChangeReceiving(e){var t="",a="";this.receivingOptions.forEach(i=>{i.spotId==e&&(t=i.spotName,a=i.address)}),this.validateForm.receivingName=t,this.validateForm.receiningAddress=a},async onChangeConsignee(e){var t="";this.consigneeOptions.forEach(a=>{a.userId==e&&(t=a.userName)}),this.validateForm.consigneeName=t},onDateChange(){console.log(this.selectDateState),"1"==this.selectDateState?(this.dateType="monthrange",this.valueFormat="yyyy-MM"):"2"==this.selectDateState?(this.dateType="daterange",this.valueFormat="yyyy-MM-dd"):"3"==this.selectDateState&&(this.dateType="yearrange",this.valueFormat="yyyy")},onReset(){this.getSearchValidateForm(),this.searchStartEndDate=[],this.selectDateState="1",this.dateType="monthrange",this.initTableData()},onResetPrize(){this.getSearchValidateFormPrize(),this.getPrizeList(this.jackpotId)},onSearch(e){this.$refs[e].validate(e=>{if(!e)return console.log("error submit!!"),!1;this.showTable=!0,this.initTableData()})},onSearchPrize(e){this.showTable=!0,this.getPrizeList(this.jackpotId)},exportExcel(){this.$confirm("确认导出Excel表格?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{this.downloadLoading=!0,await this.getExportTableData(),this.downloadLoading=!1}).catch(()=>{this.$message({type:"info",message:"已取消导出Excel表格"})})},onAdd(){this.drawer=!0,this.drawerTitle="添加",this.validateForm={}},onAddPrize(){this.drawerPrize=!0,this.drawerTitlePrize="添加",this.validateFormPrize={}},onPreview(e){this.$refs[e].validate(async e=>{if(!e)return console.log("error submit!!"),!1;var t=await this.getByOrderNumber(),a=t.data;a&&a.length>0?(this.dialogVisible=!0,this.dialogState="preview"):this.$message({message:"请输入有效单号",type:"warning"})})},editRow(e,t){this.drawer=!0,this.drawerTitle="编辑";var a=Object.assign({},t);this.validateForm=a},handleEditPrize(e,t){this.drawerPrize=!0,this.drawerTitlePrize="编辑";var a=Object.assign({},t);a.wayType=0==a.wayType?"":a.wayType,this.validateFormPrize=a;var i=this.validateFormPrize.probability1.split("-");if(9==i[1])this.validateFormPrize.probability1=parseFloat(this.validateFormPrize.probability1).toFixed(9);else if(8==i[1])this.validateFormPrize.probability1=parseFloat(this.validateFormPrize.probability1).toFixed(8);else if(7==i[1])this.validateFormPrize.probability1=parseFloat(this.validateFormPrize.probability1).toFixed(7);else if(6==i[1])this.validateFormPrize.probability1=parseFloat(this.validateFormPrize.probability1).toFixed(6);else if(5==i[1])this.validateFormPrize.probability1=parseFloat(this.validateFormPrize.probability1).toFixed(5);else if(4==i[1])this.validateFormPrize.probability1=parseFloat(this.validateFormPrize.probability1).toFixed(4);else{var r=parseFloat(this.validateFormPrize.probability1).toFixed(10);this.validateFormPrize.probability1=parseFloat(r)}console.log(this.validateFormPrize)},handleDeletePrize(e,t){this.$confirm("此操作将删除该行数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const{data:e}=await this.$http.post("/system/broadcastHunt/delectTreasureNewHunt",{treasureId:t.treasureId});"200"==e.state?(this.$message({type:"success",message:e.msg,offset:100,center:!0,duration:1e3}),this.getPrizeList(this.jackpotId)):this.$message({type:"error",message:e.msg,offset:100,center:!0,duration:3e3})}).catch(()=>{this.$message({type:"info",message:"已取消删除",offset:100,center:!0,duration:1e3})})},detailRow(e,t){this.detailDialogVisible=!0,this.dialogState="detail",this.detailTableDate(t.id)},dialogClose(){this.dialogVisible=!1,this.$refs.validateForm.resetFields(),this.getValidateForm()},editDialogClose(){this.editDialogVisible=!1,this.$refs.editValidateForm.resetFields(),this.editValidateForm={}},detailDialogClose(){this.detailDialogVisible=!1},handleClose(e){e(),this.ValidateForm={}},handleClosePrize(e){e(),this.validateFormPrize={}},editHandleClose(e){e(),this.editValidateForm={}},detailHandleClose(e){e()},submitForm(e){"添加"==this.drawerTitle?(this.addTableData(),this.drawer=!1):"编辑"==this.drawerTitle&&(this.editTableData(),this.drawer=!1),this.validateForm={}},getProbability(){var e=this,t=this.prizeData;"编辑"==this.drawerTitlePrize&&(t=t.filter((function(t){return t.treasureId!==e.validateFormPrize.treasureId})));var a=this.validateFormPrize.probability1,i=0;t.forEach(e=>{i+=Number(e.probability1)});var r=i+Number(a);return r},submitFormPrize(){var e=this.getProbability();e>1?this.$message({message:"权重总和不能大于1",type:"error",offset:100,center:!0,duration:3e3}):("添加"==this.drawerTitlePrize?(this.addTableDataPrize(),this.drawerPrize=!1):"编辑"==this.drawerTitlePrize&&(this.editTableDataPrize(),this.drawerPrize=!1),this.validateFormPrize={})},async addTableDataPrize(){let e=new FormData;e.append("file",this.file),e.append("treasureName",this.validateFormPrize.treasureName),e.append("treasureType",this.validateFormPrize.treasureType),e.append("couponAmount",this.validateFormPrize.couponAmount),e.append("inventory",this.validateFormPrize.inventory),e.append("startValidity",c(this.validateFormPrize.startValidity)),e.append("endValidity",c(this.validateFormPrize.endValidity)),e.append("prizeSize",this.validateFormPrize.prizeSize),e.append("probability1",this.validateFormPrize.probability1),e.append("shopId",this.validateFormPrize.shopId),e.append("commodityType",this.validateFormPrize.commodityType),e.append("wayType",""==this.validateFormPrize.wayType?0:this.validateFormPrize.wayType),e.append("jackpotId",this.jackpotId),e.append("userExpiration",this.validateFormPrize.userExpiration);const{data:t}=await this.$http.post("/system/broadcastHunt/addTreasureNewHunt",e);"200"==t.state?(this.$message({message:t.msg,type:"success",offset:100,center:!0,duration:1e3}),this.file="",this.fileList=[],this.getPrizeList(this.jackpotId)):this.$message({message:t.msg,type:"error",offset:100,center:!0,duration:3e3})},async editTableDataPrize(){let e=new FormData;e.append("file",this.file),e.append("treasureName",this.validateFormPrize.treasureName),e.append("treasureType",this.validateFormPrize.treasureType),e.append("couponAmount",void 0==this.validateFormPrize.couponAmount?"":this.validateFormPrize.couponAmount),e.append("inventory",this.validateFormPrize.inventory),e.append("startValidity",c(this.validateFormPrize.startValidity)),e.append("endValidity",c(this.validateFormPrize.endValidity)),e.append("prizeSize",this.validateFormPrize.prizeSize),e.append("probability1",this.validateFormPrize.probability1),e.append("shopId",this.validateFormPrize.shopId||""),e.append("commodityType",this.validateFormPrize.commodityType||""),e.append("treasureId",this.validateFormPrize.treasureId),e.append("wayType",""==this.validateFormPrize.wayType?0:this.validateFormPrize.wayType),e.append("jackpotId",this.jackpotId),e.append("userExpiration",this.validateFormPrize.userExpiration);const{data:t}=await this.$http.post("/system/broadcastHunt/editTreasureNewHunt",e);"200"==t.state?(this.$message({message:t.msg,type:"success",offset:100,center:!0,duration:1e3}),this.file="",this.fileList=[],this.getPrizeList(this.jackpotId)):this.$message({message:t.msg,type:"error",offset:100,center:!0,duration:3e3})},async addTableData(){const{data:e}=await this.$http.post("/system/broadcastHunt/addJackpotNew",this.validateForm);"200"==e.state?(this.$message({message:e.msg,type:"success",offset:100,center:!0,duration:1e3}),this.file="",this.initTableData()):this.$message({message:e.msg,type:"error",offset:100,center:!0,duration:3e3})},async editTableData(){const{data:e}=await this.$http.post("/system/broadcastHunt/updateJackpotNew",this.validateForm);"200"==e.state?(this.$message({message:e.msg,type:"success",offset:100,center:!0,duration:1e3}),this.file="",this.initTableData()):this.$message({message:e.msg,type:"error",offset:100,center:!0,duration:3e3})},onSave(){this.dialogVisible=!1,this.initTableData()},onDownloadOrder(){},onCurrentChange(e){this.currentPage=e,this.initTableData(!0)},onSizeChange(e){this.pageSize=e,this.initTableData(!0)},handleChange(e,t){console.log(e),this.fileTemp=e.raw,this.fileTemp?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==this.fileTemp.type||"application/vnd.ms-excel"==this.fileTemp.type?this.importfxx(this.fileTemp):this.$message({type:"warning",message:"附件格式错误，请删除后重新上传！"}):this.$message({type:"warning",message:"请上传附件！"})},handleExceed(e,t){this.$message.warning(`当前限制选择 1 个文件，本次选择了 ${e.length} 个文件，共选择了 ${e.length+t.length} 个文件`)},handleRemove(e,t){this.fileTemp=null},importfxx(e){this.file=e;var t=!1,i=this.file,r=new FileReader;FileReader.prototype.readAsBinaryString=function(e){var t,i,r="",s=!1,l=new FileReader;l.onload=function(e){for(var o=new Uint8Array(l.result),n=o.byteLength,d=0;d<n;d++)r+=String.fromCharCode(o[d]);var c=a("1146");t=s?c.read(btoa(fixdata(r)),{type:"base64"}):c.read(r,{type:"binary"}),i=c.utils.sheet_to_json(t.Sheets[t.SheetNames[0]]),console.log(i),this.da=[...i];let p=[];return this.da.map(e=>{let t={robotCount:e["机器人数量"],type:e["发货进度"],applicantName:e["申请人"],factoryName:e["发货工厂"],consignorName:e["发货人"],receivingName:e["收货景区"],consigneeName:e["收货人"],consigneePhone:e["收货人电话"],receiningAddress:e["收货地址"],consignmentDate:e["发货时间"]};p.push(t)}),this.tableData=p,p},l.readAsArrayBuffer(e)},t?r.readAsArrayBuffer(i):r.readAsBinaryString(i)},handleImportExceed(e){this.$refs.uploadImport.clearFiles(),this.$refs.uploadImport.submit(e)},handleImportChange(e,t){console.log(e),this.importE(e.raw)}},components:{},computed:{setTreasuretype(){return e=>{var t="";return t="1"==e?"代金卷":"2"==e?"免单":"3"==e?"实物":"5"==e?"商品":"谢谢参与",t}},setWayType(){return e=>{var t="";return"0"==e?t="":"1"==e?t="邮寄兑换":"2"==e&&(t="现场兑换"),t}},setPrizeSize(){return e=>{var t="";return t="0"==e?"普通奖品":"1"==e?"大奖":"暂无",t}},setProbability(){return e=>{var t=e.split("-");if(9==t[1])return parseFloat(e).toFixed(9);if(8==t[1])return parseFloat(e).toFixed(8);if(7==t[1])return parseFloat(e).toFixed(7);if(6==t[1])return parseFloat(e).toFixed(6);if(5==t[1])return parseFloat(e).toFixed(5);if(4==t[1])return parseFloat(e).toFixed(4);var a=parseFloat(e).toFixed(10);return parseFloat(a)}},tableContentValue(){return(e,t)=>{var a="";return"type"==t?1==e[t]?a="待发货":2==e[t]?a="已发货":3==e[t]?a="已收货":4==e[t]&&(a="已关闭"):"inStockReason"==t?1==e[t]?a="生产":2==e[t]&&(a="销售"):"inStockType"==t?1==e[t]?a="采购":2==e[t]&&(a="回收"):"jackpotType"==t?1==e[t]?a="定点寻宝":2==e[t]&&(a="定时寻宝"):a=e[t]||"无",a}}}},u=p,m=(a("9d22"),a("2877")),h=Object(m["a"])(u,n,d,!1,null,"43b19498",null),y=h.exports,b={name:"App",components:{prizePool:y}},f=b,v=(a("180b"),Object(m["a"])(f,l,o,!1,null,null,null)),g=v.exports,F=a("2f62");s["default"].use(F["a"]);var z=new F["a"].Store({state:{},mutations:{},actions:{},modules:{}}),P=a("bc3a"),w=a.n(P),S=a("4328"),T=a.n(S),k=a("313e");s["default"].use(r.a),w.a.defaults.withCredentials=!0,s["default"].prototype.$http=w.a,s["default"].prototype.$qs=T.a,s["default"].config.productionTip=!1,s["default"].prototype.$echarts=k,Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t){var i=t[a];new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i:("00"+i).substr((""+i).length)))}return e},new s["default"]({store:z,render:e=>e(g)}).$mount("#app")},"9d22":function(e,t,a){"use strict";a("f762")},da97:function(e,t,a){},f762:function(e,t,a){}});
//# sourceMappingURL=app.55989d28.js.map